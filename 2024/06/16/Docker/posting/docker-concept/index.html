<!DOCTYPE HTML>
<html lang="en">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Docker 개념 정리, Data Engineering,Data Analysis,Python Backend">
    <meta name="description" content="도커
애플리케이션 개발, 배송 및 실행을 위한 개방형 플랫폼


애플리케이션을 인프라에서 분리 하여 소프트웨어를 신속하게 제공
애플리케이션을 관리하는 것과 동일한 방식 으로 인프라를 관리
코드를 신속하게 배송, 테스">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>Docker 개념 정리 | Keyhong</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    


    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    
        <link rel="stylesheet" type="text/css" href="/css/reward.css">
    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 7.0.0"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span diy-happy-monkey">Keyhong</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>Home</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>Categories</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>About</span>
    </a>
    
  </li>
  
  <!-- <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="Search" style="zoom: 0.85;"></i>
    </a>
  </li> -->
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Keyhong</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			Home
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			Categories
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			About
		</a>
          
        </li>
        
        
    </ul>
</div>


        </div>

        
    </nav>

</header>

    

<div class="bg-cover pd-header post-cover" style="background-image: url('/images/logos/docker-logo.png')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title diy-neon-red">
                        Docker 개념 정리</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="post-cate">
                    <i class="fas fa-bookmark fa-fw icon-category"></i>
                    
                        <a href="/categories/Docker/" class="post-category">
                            Docker
                        </a>
                    
                </div>
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.min.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h2 id="도커"><a href="#도커" class="headerlink" title="도커"></a>도커</h2><blockquote>
<p>애플리케이션 개발, 배송 및 실행을 위한 개방형 플랫폼</p>
</blockquote>
<ul>
<li>애플리케이션을 <strong>인프라에서 분리</strong> 하여 소프트웨어를 신속하게 제공</li>
<li><strong>애플리케이션을 관리하는 것과 동일한 방식</strong> 으로 인프라를 관리</li>
<li>코드를 신속하게 배송, 테스트 및 배포하기 위한 Docker의 방법론을 활용하면 코드 작성과 프로덕션에서 실행 사이의 지연 시간을 크게 감소</li>
<li>이 과정을 빌드, 공유, 실행이라고 함</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://docs.docker.com/get-started/overview/">docker-overview</a></p>
<h2 id="Why-docker"><a href="#Why-docker" class="headerlink" title="Why docker?"></a>Why docker?</h2><ul>
<li>오늘날 앱을 개발하려면 코드를 작성하는 것보다 훨씬 더 많은 것이 필요</li>
<li>여러 언어, 프레임워크, 아키텍처 및 도구 간의 불연속 인터페이스 등 각 라이프사이클 단계마다 엄청난 복잡성이 발생</li>
<li>Docker는 작업 흐름을 단순화하고 가속화합니다. 개발자가 각 프로젝트에 대해 도구, 애플리케이션 스택 및 배포 환경을 선택하여 혁신할 수 있는 자유를 제공</li>
</ul>
<!-- <https://www.docker.com/why-docker/> -->


<h2 id="컨테이너"><a href="#컨테이너" class="headerlink" title="컨테이너"></a>컨테이너</h2><blockquote>
<p>애플리케이션과 애플리케이션을 실행할 컴퓨터(IP 주소, 컴퓨터 이름, 디스크 드라이브)를 담은 가상 환경</p>
</blockquote>
<ul>
<li>컨테이너는 개별 호스트명, IP주소, 디스크 드라이브를 갖음</li>
<li>모든 컨테이너는 호스트 컴퓨터의 운영체제, CPU, 메모리를 공유</li>
<li>격리(isolation)와 밀집(density)의 모순되어 보이는 두 건을 동시에 만족<ul>
<li>격리 : 런타임 버전의 차이, 호환되지 않는 라이브러리, 한 애플리케이션의 과다 리소스 사용 때문에 서로 독립된 환경에서 실행</li>
<li>밀집 : 컴퓨터에 CPU와 메모리가 허용하는 한 되도록 많은 수의 애플리케이션을 실행</li>
</ul>
</li>
</ul>
<img src="https://onedrive.live.com/embed?resid=1133AC7476AA0922%219889&authkey=%21AL93oF8oDVdAWiY&width=785&height=419" width="785" height="419" />


<h3 id="컨테이너의-상태"><a href="#컨테이너의-상태" class="headerlink" title="컨테이너의 상태"></a>컨테이너의 상태</h3><ul>
<li><p>컨테이너 내부의 애플리케이션이 실행 중이어야 컨테이너 상태도 실행 중 (종료시 Existed)</p>
</li>
<li><p>컨테이너가 종료돼도 컨테이너는 사라지지 않음 (다시 실행, 로그 확인, 파일 시스템에 내외부로 파일 복사 가능)</p>
<ul>
<li>컨테이너의 CPU 자원이나 메모리는 사용하지 않음</li>
<li>파일시스템이 남아있어 디스크 공간은 점유</li>
</ul>
</li>
</ul>
<h2 id="Docker-Container-Command"><a href="#Docker-Container-Command" class="headerlink" title="Docker Container Command"></a>Docker Container Command</h2><ul>
<li>컨테이너 실행</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">docker</span> container run <span class="token operator">&lt;</span>이미지<span class="token operator">></span>
    -d, <span class="token parameter variable">--detach</span>  <span class="token builtin class-name">:</span> 컨테이너를 백그라운드에서 실행, 컨테이너 ID 출력
    -p, <span class="token parameter variable">--publish</span> <span class="token builtin class-name">:</span> 컨테이너의 포트를 호스트 컴퓨터에 공개
    -n, <span class="token parameter variable">--name</span>    <span class="token builtin class-name">:</span> 컨테이너 ID 뿐 아니라, 사용자가 명명한 컨테이너의 이름으로 컨테이너 실행
    <span class="token parameter variable">--env</span>         <span class="token builtin class-name">:</span> 도커 이미지의 환경변수 설정값을 컨테이너에서 새롭게 설정 <span class="token punctuation">(</span>도커의 환경변수는 HOST OS의 환경변수와 별개<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>컨테이너 실행 후 터미널 연결</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">docker</span> container run <span class="token parameter variable">--interactive</span> <span class="token parameter variable">--tty</span> <span class="token operator">&lt;</span>이미지<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li>컨테이너 리스트 보기</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">docker</span> container <span class="token function">ls</span>
    -a, <span class="token parameter variable">-all</span>    <span class="token builtin class-name">:</span> 모든 컨테이너 보기
    -q, <span class="token parameter variable">--quiet</span> <span class="token builtin class-name">:</span> 컨테이너 ID만 표시<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ul>
<li>대상 컨테이너에서 실행중인 프로세스 보기</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">docker</span> container <span class="token function">top</span> <span class="token operator">&lt;</span>컨테이너 ID의 일부<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li>대상 컨테이너에서 수집된 모든 로그 보기</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">docker</span> container logs <span class="token operator">&lt;</span>컨테이너 ID의 일부<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li>대상 컨테이너의 상세한 정보 보기</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">docker</span> container inspect <span class="token function">ls</span> <span class="token operator">&lt;</span>컨테이너의 ID의 일부<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li>실행중인 컨테이너의 상태(CPU, 메모리, 네트워크, 디스크 사용량)</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">docker</span> container stats <span class="token operator">&lt;</span>컨테이너의 ID의 일부<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li>컨테이너 삭제</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">docker</span> container <span class="token function">rm</span> <span class="token operator">&lt;</span>컨테이너 ID 또는 컨테이너명<span class="token operator">></span>
    -f, <span class="token parameter variable">--force</span> <span class="token builtin class-name">:</span> 실행중인 컨테이너도 강제 삭제

<span class="token comment"># 활용 : 모든 컨테이너 삭제</span>
$ <span class="token function">docker</span> container <span class="token function">rm</span> <span class="token parameter variable">-f</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">docker</span> container <span class="token function">ls</span> <span class="token parameter variable">-aq</span><span class="token variable">)</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="Docker-Image와-Image-Layer"><a href="#Docker-Image와-Image-Layer" class="headerlink" title="Docker Image와 Image Layer"></a>Docker Image와 Image Layer</h2><blockquote>
<p>도커 이미지는 이미지 레이어가 모인 논리적 대상. 레이어는 도커 엔진의 캐시에 물리적으로 저장된 파일입니다. <strong>이미지 레이어는 여러 이미지와 컨테이너에서 공유되기 때문에 중요합니다</strong></p>
</blockquote>
<h4 id="도커-이미지-히스토리-확인"><a href="#도커-이미지-히스토리-확인" class="headerlink" title="도커 이미지 히스토리 확인"></a>도커 이미지 히스토리 확인</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">docker</span> image <span class="token function">history</span> <span class="token punctuation">[</span>image<span class="token punctuation">]</span>

  - CREATE BY <span class="token builtin class-name">:</span> 해당 레이어를 구성한 Dockerfile 스크립트의 인스트럭션. Dockerfile 인스트럭션과 이미지레이어는 <span class="token number">1</span>:1 관계<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ul>
<li>도커 이미지는 최소한의 운영체제 레이어를 가진다. (리눅스 이미지는 약 75MB의 디스크 용량을 차지)<ul>
<li><code>docker image ls</code> 명령어를 통해 SIZE 확인가능. 하지만 이는 논리적 용량일 뿐, 해당 이미지가 실제로 차지하는 디스크 용량이 아비니다.</li>
<li><code>docker system df</code> 명령어를 통해 실제 사용된 디스크 용량 확인 가능합니다.</li>
</ul>
</li>
</ul>
<p><strong>따라서, 같은 기반 레이어를 공유하는 애플리케이션의 숫자가 많을 수록 더욱 디스크 공간을 절약 가능</strong><br><strong>이미지 레이어를 여러 이미지가 공유한다면, 공유되는 레이어는 수정할 수 없어야 합니다. 도커는 이미지 레이어를 읽기 전용으로 만듭니다.</strong></p>
<ul>
<li>이러한 이유로 이미지를 빌드하면서 만들어지는 레이어를 최적화하는 것이 필요합니다. 즉, Dockerfile 스크립트의 인스트럭션의 순서를 최적화하여 도커 이미지의 용량을 줄이고 빌드를 빠르게 만드는 기법을 활용합니다.</li>
</ul>
<h2 id="이미지-레이어-캐시를-이용하여-Dockerfile-스크립트-최적화"><a href="#이미지-레이어-캐시를-이용하여-Dockerfile-스크립트-최적화" class="headerlink" title="이미지 레이어 캐시를 이용하여 Dockerfile 스크립트 최적화"></a>이미지 레이어 캐시를 이용하여 Dockerfile 스크립트 최적화</h2><ul>
<li><p>도커의 이미지 레이어가 특정한 순서대로만 배치된다고 가정하기 때문에, 순서의 중간에 있는 레이어가 변경되면 변경된 레이어보다 위에 오는 레이어를 재사용 불가</p>
</li>
<li><p>Dockerfile 스크립트의 인스트럭션은 각각 하나의 이미지 레이어와 1:1로 연결</p>
</li>
<li><p>인스트럭션의 결과가 이전 빌드와 같다면, 이전에 캐시된 레이어를 재사용</p>
</li>
</ul>
<p><strong>캐시에 일치하는 레이어가 있는지 확인하기 위해 해시값을 이용. 기존 이미지 레이어에 해시값이 일치하는 것이 없다면 캐시 미스 발생 및 인스트럭션 실행</strong></p>
<ul>
<li><p>해시값은 Dockerfile 스크립트의 인스트럭션과 인스트럭션에 의해 복사되는 파일의 내용으로부터 계산</p>
</li>
<li><p>예를 들어 app.js의 파일이 변경된다면 <code>COPY app.js .</code> 이후에 실행되는 인스트럭션은 변화가 없더라도 재사용이 불가능합니다. 이런 경우, 변경이 언제든 발생가능한 COPY 인스트럭션을 제일 상위 레이어로 올림(마지막 실행)으로써 캐시를 적극 활용합니다. 이미지를 공유하는 과정에서 시간, 디스크 용량, 네트워크 대역폭을 모두 절약할 수 있는 방법이기도 합니다.</p>
</li>
</ul>
<pre class="line-numbers language-docker" data-language="docker"><code class="language-docker"><span class="token instruction"><span class="token keyword">FROM</span> diamol/node</span>

<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">"node"</span>, <span class="token string">"/web-ping/app.js"</span>]</span>

<span class="token instruction"><span class="token keyword">ENV</span> TARGET=<span class="token string">"blog.sixeyed.com"</span> <span class="token operator">\</span>
    METHOD=<span class="token string">"HEAD"</span> <span class="token operator">\</span>
    INTERVAL=<span class="token string">"3000"</span></span>

<span class="token instruction"><span class="token keyword">WORKDIR</span> /web-ping</span>
<span class="token instruction"><span class="token keyword">COPY</span> app.js .</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="Docker-Image-Command"><a href="#Docker-Image-Command" class="headerlink" title="Docker Image Command"></a>Docker Image Command</h2><h4 id="이미지-목록-확인"><a href="#이미지-목록-확인" class="headerlink" title="이미지 목록 확인"></a>이미지 목록 확인</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">docker</span> images <span class="token operator">|</span> <span class="token function">docker</span> image <span class="token function">ls</span>
  -<span class="token string">'문자열*'</span> <span class="token builtin class-name">:</span> 특정 문자로 시작하는 이미지 목록 조회<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h4 id="이미지-다운로드"><a href="#이미지-다운로드" class="headerlink" title="이미지 다운로드"></a>이미지 다운로드</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">docker</span> image pull <span class="token operator">&lt;</span>이미지명<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h4 id="이미지-빌드"><a href="#이미지-빌드" class="headerlink" title="이미지 빌드"></a>이미지 빌드</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">docker</span> image build <span class="token parameter variable">--tag</span> <span class="token operator">&lt;</span>이미지명<span class="token operator">></span> <span class="token punctuation">[</span>컨텍스트 <span class="token builtin class-name">:</span> Dockerfile 및 이미지에 포함시킬 파일이 위치한 경로<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h4 id="이미지-히스토리-확인"><a href="#이미지-히스토리-확인" class="headerlink" title="이미지 히스토리 확인"></a>이미지 히스토리 확인</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">docker</span> image <span class="token function">history</span> <span class="token operator">&lt;</span>이미지명<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h4 id="이미지-모두-제거"><a href="#이미지-모두-제거" class="headerlink" title="이미지 모두 제거"></a>이미지 모두 제거</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># rm -f (--force) : 강제 제거(SIGKILL)</span>
<span class="token comment"># ls -f (--filter) : 제공된 조건에 따라 필터링</span>
<span class="token function">docker</span> image <span class="token function">rm</span> <span class="token parameter variable">-f</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">docker</span> image <span class="token function">ls</span> <span class="token parameter variable">-f</span> <span class="token assign-left variable">reference</span><span class="token operator">=</span><span class="token string">'&lt;조건>'</span> <span class="token parameter variable">-q</span> <span class="token variable">)</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>


<h2 id="컨테이너-네트워크"><a href="#컨테이너-네트워크" class="headerlink" title="컨테이너 네트워크"></a>컨테이너 네트워크</h2><ul>
<li><p>도커를 설치하면 호스트 컴퓨터의 네트워크 계층에 도커가 난입</p>
</li>
<li><p>호스트 컴퓨터의 네트워크 트래픽을 가로채 필요한 것을 컨테이너에 전달</p>
</li>
<li><p>각 컨테이너는 고유의 IP주소를 갖음 (도커가 관리하는 내부 가상 네트워크의 주소)</p>
</li>
<li><p>호스트 컴퓨터의 물리 네트워크는 컨테이너 IP 주소에 접근 불가 (도커가 만든 가상 네트워크이기 때문)</p>
</li>
<li><p>컨테이너 포트를 공개하는 것은 도커가 호스트 컴퓨터의 포트를 해당 포트로 들어오는 트래픽으로 전달 (포트포워딩)</p>
</li>
</ul>
<img src="https://onedrive.live.com/embed?resid=1133AC7476AA0922%219890&authkey=%21APmEFi1UVvewFZ0&width=660" width="660" height="auto" />


<h2 id="Dockerfile-이란"><a href="#Dockerfile-이란" class="headerlink" title="Dockerfile 이란?"></a>Dockerfile 이란?</h2><blockquote>
<p>애플리케이션을 패키징하기 위한 간단한 스크립트입니다. 일련의 인스트럭션으로 구성, 인스트럭션을 실행한 결과로 도커 이미지 생성됩니다.</p>
</blockquote>
<ul>
<li>도커 컨테이너에도 단일 드라이브로 된 파일 시스템이 있습니다. 이 파일 시스템은 레이어를 쌓아 올린 이미지 속 파일로부터 생성됩니다.</li>
</ul>
<h2 id="Dockerfile-작성하기"><a href="#Dockerfile-작성하기" class="headerlink" title="Dockerfile 작성하기"></a>Dockerfile 작성하기</h2><h4 id="Dockerfile-예시"><a href="#Dockerfile-예시" class="headerlink" title="Dockerfile 예시"></a>Dockerfile 예시</h4><pre class="line-numbers language-docker" data-language="docker"><code class="language-docker"><span class="token instruction"><span class="token keyword">FROM</span> example/node</span>

<span class="token instruction"><span class="token keyword">ENV</span> TARGET=<span class="token string">"hi, it's my example"</span> </span>
<span class="token instruction"><span class="token keyword">ENV</span> FUNC=<span class="token string">"Hello"</span></span>
<span class="token instruction"><span class="token keyword">ENV</span> INTERVAL=<span class="token string">"3000"</span></span>

<span class="token instruction"><span class="token keyword">WORKDIR</span> /my-workspace</span>
<span class="token instruction"><span class="token keyword">COPY</span> app.js .</span>

<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">"node"</span>, <span class="token string">"/my-workspace/app.js"</span>]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><p><code>FROM</code>: 모든 이미지는 다른 이미지로부터 출발. 이 이미지의 시작점은 example&#x2F;node 이다. 이 이미지에는 my-workspace 앱을 실행하는 데 필요한 런타임인 Node.js가 설치되어 있다.</p>
</li>
<li><p><code>ENV</code>: 환경 변수 값을 지정하기 위한 인스트럭션. 값을 지정하기 위해 [key]&#x3D;”[value]” 형식을 따름</p>
</li>
<li><p><code>WORKDIR</code>: 컨테이너 이미지 파일 시스템에 디렉토리를 만들고, 해당 디렉토리를 작업 디렉토리로 지정하는 인스트럭션. 구분자로 “&#x2F;“ (슬래시)를 사용 (window, linux 동일)</p>
</li>
<li><p><code>COPY</code>: 로컬 파일 시스템의 파일 혹은 디렉토리를 컨테이너 이미지로 복사하는 인스트럭션. “COPY [원본경로] [복사경로]” 형식으로 지정</p>
</li>
<li><p><code>CMD</code>: 이미지로부터 컨테이너를 실행했을 때, 실행할 명령을 지정하는 인스트럭션</p>
</li>
</ul>
<h2 id="컨테이너-이미지-빌드하기"><a href="#컨테이너-이미지-빌드하기" class="headerlink" title="컨테이너 이미지 빌드하기"></a>컨테이너 이미지 빌드하기</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">docker</span> image build <span class="token parameter variable">--tag</span> <span class="token operator">&lt;</span>tag명<span class="token operator">></span> <span class="token operator">&lt;</span>Dockerfile의 상대경로<span class="token operator">></span>

<span class="token comment"># tag명은 네이밍 할 이미지의 이름입니다. 보통 "keyhong/myapp-1.0.0"처럼 "사용자/앱이름-버전" 형식으로 쓰는 것이 관례입니다."</span>
<span class="token comment"># Dockerfile의 상대경로로 '.'이 default 값인데, 이는 현재 작업 디렉토리를 의미합니다.</span>

<span class="token comment"># 성공시 "successfully built", "successfully tagged" 메세지 출력</span>
<span class="token comment"># 빌드된 이미지는 로컬 이미지 캐시에 저장, 도커 명령(docker image ls 'm*' 으로 'm'으로 시작하는 이미지 목록 조회)으로 확인</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>





<h2 id="Docker-Compose-Command"><a href="#Docker-Compose-Command" class="headerlink" title="Docker Compose Command"></a>Docker Compose Command</h2><ol>
<li>docker-compose.yaml 실행</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># daemon으로 도커 컴포즈 올리기</span>
$ <span class="token function">docker-compose</span> up <span class="token parameter variable">-d</span>

<span class="token comment"># 특정 compose yaml 파일을 지정해서 올리기</span>
$ <span class="token function">docker</span> compose <span class="token parameter variable">-f</span> <span class="token operator">&lt;</span>docker-compose-example.yaml<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>도커 이미지 다운로드 및 실행하기</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 도커 image 빌드와 container 실행을 한번에 하기</span>
<span class="token comment"># --tty : TeleTYpewriter (컨테이너에 접속된 상태)</span>
<span class="token comment"># --iteractive (터미널 세션을 통해 컨테이너를 조작)</span>

$ <span class="token function">docker</span> container run <span class="token parameter variable">-it</span> python:3.7.13 /bin/bash
$ <span class="token function">docker</span> container run <span class="token parameter variable">-it</span> python:mysql:8.0.29 /bin/bash<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># dockerhub에서 이미지 다운로드</span>
$ <span class="token function">docker</span> pull centos

<span class="token comment"># 도커 컨테이너의 hostname을 등록해서 올리기</span>
$ <span class="token function">docker</span> run <span class="token parameter variable">--name</span> centos-test <span class="token parameter variable">--hostname</span> centos-test centos

<span class="token comment"># 로컬에 설치된 모든 도커 이미지 조회</span>
$ <span class="token function">docker</span> images <span class="token parameter variable">-a</span>

<span class="token comment"># 실행중인 도커 컨테이너 확인</span>
$ <span class="token function">docker</span> <span class="token function">ps</span>

<span class="token comment"># 실행중인 도커 컨테이너와 중지중인 도커 컨테이너 모두 보기</span>
$ <span class="token function">docker</span> <span class="token function">ps</span> <span class="token parameter variable">-a</span>

<span class="token comment"># dockerhub에서 image 검색하기</span>
$ <span class="token function">docker</span> search mysql

NAME                                    DESCRIPTION                                      STARS     OFFICIAL
mysql                                   MySQL is a widely used, open-source relation…   <span class="token number">15195</span>     <span class="token punctuation">[</span>OK<span class="token punctuation">]</span>
mariadb                                 MariaDB Server is a high performing <span class="token function">open</span> sou…   <span class="token number">5783</span>      <span class="token punctuation">[</span>OK<span class="token punctuation">]</span>
percona                                 Percona Server is a fork of the MySQL relati…   <span class="token number">629</span>       <span class="token punctuation">[</span>OK<span class="token punctuation">]</span>
phpmyadmin                              phpMyAdmin - A web interface <span class="token keyword">for</span> MySQL and M…   <span class="token number">1001</span>      <span class="token punctuation">[</span>OK<span class="token punctuation">]</span>
circleci/mysql                          MySQL is a widely used, open-source relation…   <span class="token number">30</span>
bitnami/mysql                           Bitnami container image <span class="token keyword">for</span> MySQL                <span class="token number">111</span>
cimg/mysql                                                                               <span class="token number">3</span>
bitnami/mysqld-exporter                 Bitnami container image <span class="token keyword">for</span> MySQL Server Exp…   <span class="token number">7</span>
ubuntu/mysql                            MySQL <span class="token function">open</span> <span class="token builtin class-name">source</span> fast, stable, multi-thread…   <span class="token number">64</span>
bitnamicharts/mysql                                                                      <span class="token number">0</span>
rapidfort/mysql                         RapidFort optimized, hardened image <span class="token keyword">for</span> MySQL    <span class="token number">25</span>
google/mysql                            MySQL server <span class="token keyword">for</span> Google Compute Engine           <span class="token number">25</span>
elestio/mysql                           Mysql, verified and packaged by Elestio          <span class="token number">0</span>
airbyte/source-mysql                                                                     <span class="token number">0</span>
airbyte/normalization-mysql                                                              <span class="token number">0</span>
rapidfort/mysql8-ib                     RapidFort optimized, hardened image <span class="token keyword">for</span> MySQ…   <span class="token number">9</span>
newrelic/k8s-nri-mysql                  New Relic Infrastructure MySQL Integration <span class="token punctuation">(</span>…   <span class="token number">0</span>
rapidfort/mysql-official                RapidFort optimized, hardened image <span class="token keyword">for</span> MySQ…   <span class="token number">9</span>
hashicorp/mysql-portworx-demo                                                            <span class="token number">0</span>
airbyte/destination-mysql                                                                <span class="token number">0</span>
bitnami/percona-mysql                   Bitnami container image <span class="token keyword">for</span> Percona MySQL        <span class="token number">0</span>
percona/percona-server-mysql-operator                                                    <span class="token number">0</span>
newrelic/mysql-plugin                   New Relic Plugin <span class="token keyword">for</span> monitoring MySQL databa…   <span class="token number">1</span>
linuxserver/mysql                       A Mysql container, brought to you by LinuxSe…   <span class="token number">41</span>
airbyte/source-mysql-strict-encrypt                                                      <span class="token number">0</span>


<span class="token comment"># 외부에서 접속할 포트(포트포워딩)을 지정해서 올리기</span>
$ <span class="token function">docker</span> run  <span class="token parameter variable">-p</span> <span class="token number">13306</span>:3306 mysql

<span class="token comment"># 컨테이너 이름을 지정해서 올리기</span>
$ <span class="token function">docker</span> run <span class="token parameter variable">--name</span> container_name_alias mysql

<span class="token comment"># 컨테이너 내부 환경변수를 설정하여 올리기</span>
$ <span class="token function">docker</span> run <span class="token parameter variable">-e</span> <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span>password mysql

<span class="token comment"># 로컬 디렉터리 경로와 컨테이너 내부 디렉터리 경로를 볼륨마운트해서 올리기</span>
$ <span class="token function">docker</span> run <span class="token parameter variable">-v</span> /Users/jmlim/datadir:/var/lib/mysql mysql

<span class="token comment"># restart 옵션을 주면서 컨테이너 실행하기</span>
<span class="token comment"># https://docs.docker.com/config/containers/start-containers-automatically/#use-a-restart-policy</span>
$ <span class="token function">docker</span> run <span class="token parameter variable">--restart</span> unless-stopped mysql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>실행중인 도커 컨테이너에 새 프롬프트로 접근하기</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 실행중인 docker container에 bash 쉘 프롬프트로 접근하기</span>
$ <span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> <span class="token operator">&lt;</span>container name<span class="token operator">></span> <span class="token function">bash</span>
   - i <span class="token builtin class-name">:</span> interactive <span class="token punctuation">(</span>입출력 stdin, stdout 사용<span class="token punctuation">)</span>
   - t <span class="token builtin class-name">:</span> terminal <span class="token punctuation">(</span>터미널<span class="token punctuation">)</span>

<span class="token comment"># Example 1: MySQL</span>
$ <span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> <span class="token operator">&lt;</span>container name<span class="token operator">></span> /bin/bash

<span class="token comment"># Example 2: Python</span>
$ <span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> <span class="token operator">&lt;</span>container name<span class="token operator">></span> /bin/bash<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="4">
<li>실행중인 도커 컨테이너의 기존 프로세스 프롬프트에 접근하기</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 실행중인 도커 컨테이너의 기존 프로세스 프롬프트에 접근하기</span>
$ <span class="token function">docker</span> attach <span class="token operator">&lt;</span>container ID<span class="token operator">></span> 
$ <span class="token function">docker</span> attach db762f62f2f9<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ol start="5">
<li>중지중인 도커 컨테이너 재실행하기</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 중지중인 도커 컨테이너 재실행 </span>
$ <span class="token function">docker</span> start <span class="token operator">&lt;</span>container name 또는 ID<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        Author:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">Keyhong</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        Link:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://example.com/2024/06/16/Docker/posting/docker-concept/">http://example.com/2024/06/16/Docker/posting/docker-concept/</a>
                </span>
            </div>
            <!-- <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        reprint:
                    </i>
                </span>
                <span class="reprint-info">
                    use
                    <a href="cc_by_url" rel="external nofollow noreferrer" target="_blank">cc_by_name</a>
                    licensed
                    <a href="/about" target="_blank">Keyhong</a>
                    !
                </span>
            </div> -->
        
    </div>

    <!-- <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>Copied successfully, please follow the reprint policy of this article</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">more</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script> -->



            <div class="tag_share" style="display: block;">
                <!-- <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            <span class="chip bg-color">No tag</span>
                        </div>
                    
                </div> -->
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    

    

</div>

                </div>
            </div>
            
                <div id="reward">
    <!-- <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a> -->

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    


    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;Previous</div>
            <div class="card">
                <a href="/2024/06/16/Docker/posting/docker-mysql-connection/">
                    <div class="card-image">
                        
                        <img src="/images/logos/docker-logo.png" class="responsive-img" alt="docker mysql">
                        
                        <span class="card-title diy-neon-red">docker mysql</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2024-06-16
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Docker/" class="post-category">
                                    Docker
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                Next&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2024/06/16/Django/posting/model-orm/">
                    <div class="card-image">
                        
                        <img src="/images/logos/django-logo.png" class="responsive-img" alt="Django 모델 (ORM)">
                        
                        <span class="card-title diy-neon-red">Django 모델 (ORM)</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2024-06-16
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Django/" class="post-category">
                                    Django
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>


  <!-- 是否加载使用自带的 prismjs. -->
  <script type="text/javascript" src="/libs/prism/prism.min.js"></script>


<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;목차</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>


<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2024</span>
            
            <a href="/about" target="_blank">Gyuwon Hong</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            
            <br>
            
            
            
            
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link ">
    <a href="https://github.com/keyhong" class="tooltipped" target="_blank" data-tooltip="GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:wnhong96@gmail.com" class="tooltipped" target="_blank" data-tooltip="Email" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>













</div>
    </div>
</footer>

<div class="progress-bar"></div>


    
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;Search</span>
            <input type="search" id="searchInput" name="s" placeholder="Please enter a search keyword"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- Back to Top Button -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    
    
    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>

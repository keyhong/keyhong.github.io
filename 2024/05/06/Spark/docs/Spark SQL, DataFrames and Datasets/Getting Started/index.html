<!DOCTYPE HTML>
<html lang="en">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="[Spark] Spark SQL, DataFrames and Datasets - Getting Started, Data Engineering,Data Analysis,Python Backend">
    <meta name="description" content="Starting Point: SparkSession모든 Spark 기능의 진입점은 SparkSession 클래스입니다. 기본적인 SparkSession을 생성하려면 SparkSession.builder()를 사용하십">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>[Spark] Spark SQL, DataFrames and Datasets - Getting Started | Keyhong</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    


    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    
        <link rel="stylesheet" type="text/css" href="/css/reward.css">
    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 7.0.0"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span diy-happy-monkey">Keyhong</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>Index</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>Categories</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>About</span>
    </a>
    
  </li>
  
  <!-- <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="Search" style="zoom: 0.85;"></i>
    </a>
  </li> -->
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Keyhong</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			Index
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			Categories
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			About
		</a>
          
        </li>
        
        
    </ul>
</div>


        </div>

        
    </nav>

</header>

    

<div class="bg-cover pd-header post-cover" style="background-image: url('/images/logos/pyspark-logo.png')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title diy-neon-red">
                        [Spark] Spark SQL, DataFrames and Datasets - Getting Started</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                        <div class="article-tag">
                            <i class="far fa-calendar-minus fa-fw"></i>Publish Date:&nbsp;&nbsp;
                                <span class="chip bg-color">
                                    2024-05-06</span>
                        </div>
                    
                    


                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/Spark/" class="post-category">
                                Spark
                            </a>
                        
                    </div>
                    
                </div>
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.min.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="Starting-Point-SparkSession"><a href="#Starting-Point-SparkSession" class="headerlink" title="Starting Point: SparkSession"></a>Starting Point: SparkSession</h1><p>모든 Spark 기능의 진입점은 <a target="_blank" rel="noopener" href="https://spark.apache.org/docs/latest/api/scala/org/apache/spark/sql/SparkSession.html">SparkSession</a> 클래스입니다. 기본적인 SparkSession을 생성하려면 <code>SparkSession.builder()</code>를 사용하십시오:</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>spark<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">SparkSession</span>

val spark <span class="token operator">=</span> <span class="token class-name">SparkSession</span><span class="token punctuation">.</span>
  <span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">appName</span><span class="token punctuation">(</span><span class="token string">"Spark SQL basic example"</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">config</span><span class="token punctuation">(</span><span class="token string">"spark.some.config.option"</span><span class="token punctuation">,</span> <span class="token string">"some-value"</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">getOrCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Spark 저장소의 “examples&#x2F;src&#x2F;main&#x2F;scala&#x2F;org&#x2F;apache&#x2F;spark&#x2F;examples&#x2F;sql&#x2F;SparkSQLExample.scala”에서 전체 예제 코드를 찾을 수 있습니다. Spark 2.0의 SparkSession은 Hive 기능을 내장 지원하며, HiveQL을 사용하여 쿼리를 작성하고, Hive UDF에 액세스하며, Hive 테이블에서 데이터를 읽을 수 있습니다. 이러한 기능을 사용하려면 기존의 Hive 설정이 필요하지 않습니다.</p>
<h1 id="Creating-DataFrames"><a href="#Creating-DataFrames" class="headerlink" title="Creating DataFrames"></a>Creating DataFrames</h1><p>SparkSession을 사용하면 응용 프로그램은 <a target="_blank" rel="noopener" href="https://spark.apache.org/docs/latest/sql-getting-started.html#interoperating-with-rdds">existing RDD</a>, Hive 테이블 또는 <a target="_blank" rel="noopener" href="https://spark.apache.org/docs/latest/sql-data-sources.html">Spark data sources</a>에서 DataFrame을 생성할 수 있습니다.</p>
<p>예를 들어, 다음은 JSON 파일의 내용을 기반으로 DataFrame을 생성합니다:</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">val df <span class="token operator">=</span> spark<span class="token punctuation">.</span>read<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token string">"examples/src/main/resources/people.json"</span><span class="token punctuation">)</span>

<span class="token comment">// Displays the content of the DataFrame to stdout</span>
df<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// +----+-------+</span>
<span class="token comment">// | age|   name|</span>
<span class="token comment">// +----+-------+</span>
<span class="token comment">// |null|Michael|</span>
<span class="token comment">// |  30|   Andy|</span>
<span class="token comment">// |  19| Justin|</span>
<span class="token comment">// +----+-------+</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Spark 저장소의 “examples&#x2F;src&#x2F;main&#x2F;scala&#x2F;org&#x2F;apache&#x2F;spark&#x2F;examples&#x2F;sql&#x2F;SparkSQLExample.scala”에서 전체 예제 코드를 찾을 수 있습니다.</p>
<h1 id="Untyped-Dataset-Operations-aka-DataFrame-Operations"><a href="#Untyped-Dataset-Operations-aka-DataFrame-Operations" class="headerlink" title="Untyped Dataset Operations (aka DataFrame Operations)"></a>Untyped Dataset Operations (aka DataFrame Operations)</h1><p>DataFrames는 <a target="_blank" rel="noopener" href="https://spark.apache.org/docs/latest/api/scala/org/apache/spark/sql/Dataset.html">Scala</a>, <a target="_blank" rel="noopener" href="https://spark.apache.org/docs/latest/api/java/index.html?org/apache/spark/sql/Dataset.html">Java</a>, <a target="_blank" rel="noopener" href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.html">Python</a> 및 <a target="_blank" rel="noopener" href="https://spark.apache.org/docs/latest/api/R/reference/SparkDataFrame.html">R</a>에서 구조화된 데이터 조작을 위한 도메인 특화 언어를 제공합니다.</p>
<p>위에서 언급한 대로, Spark 2.0에서 DataFrames는 Scala 및 Java API의 행의 Dataset입니다. 이러한 작업은 강력한 유형의 Scala&#x2F;Java Dataset과 대조적으로 “untyped transformations”으로도 참조됩니다.</p>
<p>여기에는 Dataset을 사용한 구조화된 데이터 처리의 기본 예제를 포함했습니다:</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// This import is needed to use the $-notation</span>
<span class="token keyword">import</span> <span class="token namespace">spark<span class="token punctuation">.</span>implicits<span class="token punctuation">.</span></span>_
<span class="token comment">// Print the schema in a tree format</span>
df<span class="token punctuation">.</span><span class="token function">printSchema</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// root</span>
<span class="token comment">// |-- age: long (nullable = true)</span>
<span class="token comment">// |-- name: string (nullable = true)</span>

<span class="token comment">// Select only the "name" column</span>
df<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// +-------+</span>
<span class="token comment">// |   name|</span>
<span class="token comment">// +-------+</span>
<span class="token comment">// |Michael|</span>
<span class="token comment">// |   Andy|</span>
<span class="token comment">// | Justin|</span>
<span class="token comment">// +-------+</span>

<span class="token comment">// Select everybody, but increment the age by 1</span>
df<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span>$<span class="token string">"name"</span><span class="token punctuation">,</span> $<span class="token string">"age"</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// +-------+---------+</span>
<span class="token comment">// |   name|(age + 1)|</span>
<span class="token comment">// +-------+---------+</span>
<span class="token comment">// |Michael|     null|</span>
<span class="token comment">// |   Andy|       31|</span>
<span class="token comment">// | Justin|       20|</span>
<span class="token comment">// +-------+---------+</span>

<span class="token comment">// Select people older than 21</span>
df<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>$<span class="token string">"age"</span> <span class="token operator">></span> <span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// +---+----+</span>
<span class="token comment">// |age|name|</span>
<span class="token comment">// +---+----+</span>
<span class="token comment">// | 30|Andy|</span>
<span class="token comment">// +---+----+</span>

<span class="token comment">// Count people by age</span>
df<span class="token punctuation">.</span><span class="token function">groupBy</span><span class="token punctuation">(</span><span class="token string">"age"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// +----+-----+</span>
<span class="token comment">// | age|count|</span>
<span class="token comment">// +----+-----+</span>
<span class="token comment">// |  19|    1|</span>
<span class="token comment">// |null|    1|</span>
<span class="token comment">// |  30|    1|</span>
<span class="token comment">// +----+-----+</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>전체 예제 코드는 Spark 저장소의 “examples&#x2F;src&#x2F;main&#x2F;scala&#x2F;org&#x2F;apache&#x2F;spark&#x2F;examples&#x2F;sql&#x2F;SparkSQLExample.scala”에서 찾을 수 있습니다. Dataset에 수행할 수 있는 작업 유형의 전체 목록은 <a target="_blank" rel="noopener" href="https://spark.apache.org/docs/latest/api/scala/org/apache/spark/sql/Dataset.html">API Documentation</a>를 참조하십시오.</p>
<p>단순한 열 참조와 표현식 외에도 Dataset에는 문자열 조작, 날짜 산술, 일반 수학 연산 등이 포함된 풍부한 함수 라이브러리가 있습니다. 완전한 목록은 <a target="_blank" rel="noopener" href="https://spark.apache.org/docs/latest/api/scala/org/apache/spark/sql/functions$.html">DataFrame Function Reference</a>에서 확인할 수 있습니다.</p>
<h1 id="Running-SQL-Queries-Programmatically"><a href="#Running-SQL-Queries-Programmatically" class="headerlink" title="Running SQL Queries Programmatically"></a>Running SQL Queries Programmatically</h1><p>SparkSession의 sql 함수는 응용 프로그램이 SQL 쿼리를 프로그래밍 방식으로 실행하고 결과를 DataFrame으로 반환할 수 있도록 합니다.</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// Register the DataFrame as a SQL temporary view</span>
df<span class="token punctuation">.</span><span class="token function">createOrReplaceTempView</span><span class="token punctuation">(</span><span class="token string">"people"</span><span class="token punctuation">)</span>

val sqlDF <span class="token operator">=</span> spark<span class="token punctuation">.</span><span class="token function">sql</span><span class="token punctuation">(</span><span class="token string">"SELECT * FROM people"</span><span class="token punctuation">)</span>
sqlDF<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// +----+-------+</span>
<span class="token comment">// | age|   name|</span>
<span class="token comment">// +----+-------+</span>
<span class="token comment">// |null|Michael|</span>
<span class="token comment">// |  30|   Andy|</span>
<span class="token comment">// |  19| Justin|</span>
<span class="token comment">// +----+-------+</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Spark 저장소의 “examples&#x2F;src&#x2F;main&#x2F;scala&#x2F;org&#x2F;apache&#x2F;spark&#x2F;examples&#x2F;sql&#x2F;SparkSQLExample.scala”에서 전체 예제 코드를 찾을 수 있습니다.</p>
<h1 id="Global-Temporary-View"><a href="#Global-Temporary-View" class="headerlink" title="Global Temporary View"></a>Global Temporary View</h1><p>Spark SQL의 임시 뷰는 세션 범위로 유효하며, 해당 세션이 종료되면 사라집니다. 모든 세션 간에 공유되고 Spark 응용 프로그램이 종료될 때까지 유지하려면 전역 임시 뷰를 생성할 수 있습니다.<br>전역 임시 뷰는 시스템 보존 데이터베이스 global_temp에 연결되어 있으며, 그것을 참조하기 위해 완전한 이름을 사용해야 합니다. 예: SELECT * FROM global_temp.view1.</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// Register the DataFrame as a global temporary view</span>
df<span class="token punctuation">.</span><span class="token function">createGlobalTempView</span><span class="token punctuation">(</span><span class="token string">"people"</span><span class="token punctuation">)</span>

<span class="token comment">// Global temporary view is tied to a system preserved database `global_temp`</span>
spark<span class="token punctuation">.</span><span class="token function">sql</span><span class="token punctuation">(</span><span class="token string">"SELECT * FROM global_temp.people"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// +----+-------+</span>
<span class="token comment">// | age|   name|</span>
<span class="token comment">// +----+-------+</span>
<span class="token comment">// |null|Michael|</span>
<span class="token comment">// |  30|   Andy|</span>
<span class="token comment">// |  19| Justin|</span>
<span class="token comment">// +----+-------+</span>

<span class="token comment">// Global temporary view is cross-session</span>
spark<span class="token punctuation">.</span><span class="token function">newSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sql</span><span class="token punctuation">(</span><span class="token string">"SELECT * FROM global_temp.people"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// +----+-------+</span>
<span class="token comment">// | age|   name|</span>
<span class="token comment">// +----+-------+</span>
<span class="token comment">// |null|Michael|</span>
<span class="token comment">// |  30|   Andy|</span>
<span class="token comment">// |  19| Justin|</span>
<span class="token comment">// +----+-------+</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Spark 저장소의 “examples&#x2F;src&#x2F;main&#x2F;scala&#x2F;org&#x2F;apache&#x2F;spark&#x2F;examples&#x2F;sql&#x2F;SparkSQLExample.scala”에서 전체 예제 코드를 찾을 수 있습니다.</p>
<h1 id="Creating-Datasets"><a href="#Creating-Datasets" class="headerlink" title="Creating Datasets"></a>Creating Datasets</h1><p>Dataset은 RDD와 유사하지만, Java serialization 또는 Kryo 대신 특수화된 <a target="_blank" rel="noopener" href="https://spark.apache.org/docs/latest/api/scala/org/apache/spark/sql/Encoder.html">Encoder</a>를 사용하여 객체를 직렬화하여 처리하거나 네트워크를 통해 전송합니다. 인코더와 표준 직렬화 모두 객체를 바이트로 변환하는 역할을 하지만, 인코더는 동적으로 생성된 코드를 사용하며 Spark가 바이트를 객체로 다시 역직렬화하지 않고도 필터링, 정렬 및 해싱과 같은 많은 작업을 수행할 수 있는 형식을 사용합니다.</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">case</span> <span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token class-name">Long</span><span class="token punctuation">)</span>

<span class="token comment">// Encoders are created for case classes</span>
val caseClassDS <span class="token operator">=</span> <span class="token class-name">Seq</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Andy"</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toDS</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
caseClassDS<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// +----+---+</span>
<span class="token comment">// |name|age|</span>
<span class="token comment">// +----+---+</span>
<span class="token comment">// |Andy| 32|</span>
<span class="token comment">// +----+---+</span>

<span class="token comment">// Encoders for most common types are automatically provided by importing spark.implicits._</span>
val primitiveDS <span class="token operator">=</span> <span class="token class-name">Seq</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toDS</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
primitiveDS<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>_ <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// Returns: Array(2, 3, 4)</span>

<span class="token comment">// DataFrames can be converted to a Dataset by providing a class. Mapping will be done by name</span>
val path <span class="token operator">=</span> <span class="token string">"examples/src/main/resources/people.json"</span>
val peopleDS <span class="token operator">=</span> spark<span class="token punctuation">.</span>read<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">.</span>as<span class="token punctuation">[</span><span class="token class-name">Person</span><span class="token punctuation">]</span>
peopleDS<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// +----+-------+</span>
<span class="token comment">// | age|   name|</span>
<span class="token comment">// +----+-------+</span>
<span class="token comment">// |null|Michael|</span>
<span class="token comment">// |  30|   Andy|</span>
<span class="token comment">// |  19| Justin|</span>
<span class="token comment">// +----+-------+</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Spark 저장소의 “examples&#x2F;src&#x2F;main&#x2F;scala&#x2F;org&#x2F;apache&#x2F;spark&#x2F;examples&#x2F;sql&#x2F;SparkSQLExample.scala”에서 전체 예제 코드를 찾을 수 있습니다.</p>
<h1 id="Interoperating-with-RDDs"><a href="#Interoperating-with-RDDs" class="headerlink" title="Interoperating with RDDs"></a>Interoperating with RDDs</h1><p>Spark SQL은 기존 RDD를 Dataset으로 변환하는 두 가지 다른 방법을 지원합니다. 첫 번째 방법은 특정 유형의 객체를 포함하는 RDD의 스키마를 추론하기 위해 리플렉션을 사용합니다. 이 리플렉션 기반 접근 방식은 더 간결한 코드를 유도하며 Spark 애플리케이션을 작성하는 동안 스키마를 이미 알고 있는 경우 잘 작동합니다.</p>
<p>두 번째 방법은 기존 RDD에 스키마를 구성한 다음 적용할 수 있는 프로그래밍 인터페이스를 통해 Dataset을 생성하는 것입니다. 이 방법은 더 많은 양의 코드를 필요로하지만, 열과 그 유형이 runtime까지 알려지지 않는 경우에도 Dataset을 구성할 수 있습니다.</p>
<h2 id="Inferring-the-Schema-Using-Reflection"><a href="#Inferring-the-Schema-Using-Reflection" class="headerlink" title="Inferring the Schema Using Reflection"></a>Inferring the Schema Using Reflection</h2><p>Spark SQL의 Scala 인터페이스는 case 클래스를 포함하는 RDD를 자동으로 DataFrame으로 변환하는 기능을 지원합니다. case 클래스는 테이블의 스키마를 정의합니다. case 클래스의 인수 이름은 리플렉션을 사용하여 읽히며 열의 이름이 됩니다. case 클래스는 중첩되거나 Seqs 또는 Arrays와 같은 복잡한 유형을 포함할 수도 있습니다. 이 RDD는 암시적으로 DataFrame으로 변환될 수 있고 그런 다음 테이블로 등록될 수 있습니다. 테이블은 후속 SQL 문에서 사용할 수 있습니다.</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// For implicit conversions from RDDs to DataFrames</span>
<span class="token keyword">import</span> <span class="token namespace">spark<span class="token punctuation">.</span>implicits<span class="token punctuation">.</span></span>_

<span class="token comment">// Create an RDD of Person objects from a text file, convert it to a Dataframe</span>
val peopleDF <span class="token operator">=</span> spark<span class="token punctuation">.</span>context
  <span class="token punctuation">.</span><span class="token function">textFile</span><span class="token punctuation">(</span><span class="token string">"examples/src/main/resources/people.txt"</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>attributes <span class="token operator">=</span><span class="token operator">></span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token function">attributes</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">attributes</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>trim<span class="token punctuation">.</span>toInt<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">toDF</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// Register the DataFrame as a temporary view</span>
peopleDF<span class="token punctuation">.</span><span class="token function">createOrReplaceTempView</span><span class="token punctuation">(</span><span class="token string">"people"</span><span class="token punctuation">)</span>

<span class="token comment">// SQL statements can be run by using the sql methods provided by Spark</span>
val teenagersDF <span class="token operator">=</span> spark<span class="token punctuation">.</span><span class="token function">sql</span><span class="token punctuation">(</span><span class="token string">"SELECT name, age FROM people WHERE age BETWEEN 13 AND 19"</span><span class="token punctuation">)</span>

<span class="token comment">// The columns of a row in the result can be accessed by field index</span>
teenagersDF<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>teenager <span class="token operator">=</span><span class="token operator">></span> <span class="token string">"Name: "</span> <span class="token operator">+</span> <span class="token function">teenager</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// +------------+</span>
<span class="token comment">// |       value|</span>
<span class="token comment">// +------------+</span>
<span class="token comment">// |Name: Justin|</span>
<span class="token comment">// +------------+</span>

<span class="token comment">// or by field name</span>
teenagersDF<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>teenager <span class="token operator">=</span><span class="token operator">></span> <span class="token string">"Name: "</span> <span class="token operator">+</span> teenager<span class="token punctuation">.</span>getAs<span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// +------------+</span>
<span class="token comment">// |       value|</span>
<span class="token comment">// +------------+</span>
<span class="token comment">// |Name: Justin|</span>
<span class="token comment">// +------------+</span>

<span class="token comment">// No pre-defined encoders for Dataset[Map[K,V]], define explicitly</span>
implicit val mapEncoder <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>spark<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span>Encoders</span><span class="token punctuation">.</span>kryo<span class="token punctuation">[</span><span class="token class-name">Map</span><span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Any</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token comment">// Primitive types and case classes can be also defined as</span>
<span class="token comment">// implicit val stringIntMapEncoder: Encoder[Map[String, Any]] = ExpressionEncoder()</span>

<span class="token comment">// row.getValuesMap[T] retrieves multiple columns at once into a Map[String, T]</span>
teenagersDF<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>teenager <span class="token operator">=</span><span class="token operator">></span> teenager<span class="token punctuation">.</span>getValuesMap<span class="token punctuation">[</span><span class="token class-name">Any</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span> <span class="token string">"age"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// Array(Map("name" -> "Justin", "age" -> 19))</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>“examples&#x2F;src&#x2F;main&#x2F;scala&#x2F;org&#x2F;apache&#x2F;spark&#x2F;examples&#x2F;sql&#x2F;SparkSQLExample.scala” 경로에서 Spark 저장소의 전체 예제 코드를 찾을 수 있습니다. 프로그래밍적으로 요청하십시오.</p>
<h2 id="Programmatically-Specifying-the-Schema"><a href="#Programmatically-Specifying-the-Schema" class="headerlink" title="Programmatically Specifying the Schema"></a>Programmatically Specifying the Schema</h2><p>case 클래스를 미리 정의할 수 없는 경우(예: 레코드의 구조가 문자열로 인코딩되어 있거나 텍스트 데이터 집합이 구문 분석되고 필드가 다른 사용자에게 서로 다르게 투영될 경우) DataFrame을 세 단계로 프로그래밍 방식으로 생성할 수 있습니다.</p>
<ol>
<li>원본 RDD에서 행(Rows)의 RDD를 생성합니다.</li>
<li>단계 1에서 생성된 RDD의 행 구조와 일치하는 StructType으로 표현된 스키마를 생성합니다.</li>
<li>SparkSession에서 제공하는 createDataFrame 메서드를 사용하여 행(Rows)의 RDD에 스키마를 적용합니다.</li>
</ol>
<p>예를 들어:</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>spark<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">Row</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>spark<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>types<span class="token punctuation">.</span></span>_

<span class="token comment">// Create an RDD</span>
val peopleRDD <span class="token operator">=</span> spark<span class="token punctuation">.</span>sparkContext<span class="token punctuation">.</span><span class="token function">textFile</span><span class="token punctuation">(</span><span class="token string">"examples/src/main/resources/people.txt"</span><span class="token punctuation">)</span>

<span class="token comment">// The schema is encoded in a string</span>
val schemaString <span class="token operator">=</span> <span class="token string">"name age"</span>

<span class="token comment">// Generate the schema based on the string of schema</span>
val fields <span class="token operator">=</span> schemaString<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>fieldName <span class="token operator">=</span><span class="token operator">></span> <span class="token class-name">StructField</span><span class="token punctuation">(</span>fieldName<span class="token punctuation">,</span> <span class="token class-name">StringType</span><span class="token punctuation">,</span> nullable<span class="token operator">=</span><span class="token class-name">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
val schema <span class="token operator">=</span> <span class="token class-name">StructType</span><span class="token punctuation">(</span>fields<span class="token punctuation">)</span>

<span class="token comment">// Convert records of the RDD (people) to Rows</span>
val rowRDD <span class="token operator">=</span> peopleRDD
  <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>attributes <span class="token operator">=</span><span class="token operator">></span> <span class="token class-name">Row</span><span class="token punctuation">(</span><span class="token function">attributes</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">attributes</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>trim<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">// Apply the schema to the RDD</span>
val peopleDF <span class="token operator">=</span> spark<span class="token punctuation">.</span><span class="token function">createDataFrame</span><span class="token punctuation">(</span>rowRDD<span class="token punctuation">,</span> schema<span class="token punctuation">)</span>

<span class="token comment">// Creates a temporary view using the DataFrame</span>
peopleDF<span class="token punctuation">.</span><span class="token function">createOrReplaceTempView</span><span class="token punctuation">(</span><span class="token string">"people"</span><span class="token punctuation">)</span>

<span class="token comment">// Creates a temporary view using the DataFrame</span>
peopleDF<span class="token punctuation">.</span><span class="token function">createOrReplaceTempView</span><span class="token punctuation">(</span><span class="token string">"people"</span><span class="token punctuation">)</span>

<span class="token comment">// The results of SQL queries are DataFrames and support all the normal RDD operations</span>
<span class="token comment">// The columns of a row in the result can be accessed by field index or by field name</span>
result<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>attributes <span class="token operator">=</span><span class="token operator">></span> <span class="token string">"Name: "</span> <span class="token operator">+</span> <span class="token function">attributes</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// +-------------+</span>
<span class="token comment">// |        value|</span>
<span class="token comment">// +-------------+</span>
<span class="token comment">// |Name: Michael|</span>
<span class="token comment">// |   Name: Andy|</span>
<span class="token comment">// | Name: Justin|</span>
<span class="token comment">// +-------------+</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Spark 저장소의 “examples&#x2F;src&#x2F;main&#x2F;scala&#x2F;org&#x2F;apache&#x2F;spark&#x2F;examples&#x2F;sql&#x2F;SparkSQLExample.scala”에서 전체 예제 코드를 찾을 수 있습니다.</p>
<h1 id="Scalar-Functions"><a href="#Scalar-Functions" class="headerlink" title="Scalar Functions"></a>Scalar Functions</h1><p>스칼라 함수는 행 당 하나의 값을 반환하는 함수로, 그룹화된 행에 대한 값을 반환하는 집계 함수와는 달리 동작합니다. Spark SQL은 다양한 <a target="_blank" rel="noopener" href="https://spark.apache.org/docs/latest/sql-ref-functions.html#scalar-functions">Built-in Scalar Functions</a>를 지원합니다. 또한 <a target="_blank" rel="noopener" href="https://spark.apache.org/docs/latest/sql-ref-functions-udf-scalar.html">User Defined Scalar Functions</a>도 지원합니다.</p>
<h1 id="Aggregate-Functions"><a href="#Aggregate-Functions" class="headerlink" title="Aggregate Functions"></a>Aggregate Functions</h1><p>집계 함수는 여러 행의 그룹에 대한 단일 값을 반환하는 함수입니다. <a target="_blank" rel="noopener" href="https://spark.apache.org/docs/latest/sql-ref-functions-builtin.html#aggregate-functions">Built-in Aggregate Functions</a>는 <code>count()</code>, <code>count_distinct()</code>, <code>avg()</code>, <code>max()</code>, <code>min()</code> 등과 같은 일반적인 집계를 제공합니다. 사용자는 미리 정의된 집계 함수에 제한되지 않으며 자신의 집계 함수를 만들 수 있습니다. 사용자 정의 집계 함수에 대한 자세한 내용은 <a target="_blank" rel="noopener" href="https://spark.apache.org/docs/latest/sql-ref-functions-udf-aggregate.html">User Defined Aggregate Functions</a> 문서를 참조하십시오.</p>
<h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><ul>
<li><a target="_blank" rel="noopener" href="https://spark.apache.org/docs/latest/sql-getting-started.html">https://spark.apache.org/docs/latest/sql-getting-started.html</a></li>
</ul>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        Author:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">Keyhong</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        Link:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://example.com/2024/05/06/Spark/docs/Spark%20SQL,%20DataFrames%20and%20Datasets/Getting%20Started/">http://example.com/2024/05/06/Spark/docs/Spark%20SQL,%20DataFrames%20and%20Datasets/Getting%20Started/</a>
                </span>
            </div>
            <!-- <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        reprint:
                    </i>
                </span>
                <span class="reprint-info">
                    use
                    <a href="cc_by_url" rel="external nofollow noreferrer" target="_blank">cc_by_name</a>
                    licensed
                    <a href="/about" target="_blank">Keyhong</a>
                    !
                </span>
            </div> -->
        
    </div>

    <!-- <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>Copied successfully, please follow the reprint policy of this article</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">more</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script> -->



            <div class="tag_share" style="display: block;">
                <!-- <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            <span class="chip bg-color">No tag</span>
                        </div>
                    
                </div> -->
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    

    

</div>

                </div>
            </div>
            
                <div id="reward">
    <!-- <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a> -->

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    


    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;Previous</div>
            <div class="card">
                <a href="/2024/05/06/Spark/docs/Programming%20Guides/RDD%20Programming%20Guide/">
                    <div class="card-image">
                        
                        <img src="/images/logos/pyspark-logo.png" class="responsive-img" alt="[Spark] Programming Guides - RDD Programming Guide">
                        
                        <span class="card-title diy-neon-red">[Spark] Programming Guides - RDD Programming Guide</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2024-05-06
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Spark/" class="post-category">
                                    Spark
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                Next&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2024/05/05/Spark/docs/pyspark/Getting%20Started/Testing%20PySpark/">
                    <div class="card-image">
                        
                        <img src="/images/logos/pyspark-logo.png" class="responsive-img" alt="[Spark] pyspark - Getting Started - Testing PySpark">
                        
                        <span class="card-title diy-neon-red">[Spark] pyspark - Getting Started - Testing PySpark</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2024-05-05
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Spark/" class="post-category">
                                    Spark
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>


  <!-- 是否加载使用自带的 prismjs. -->
  <script type="text/javascript" src="/libs/prism/prism.min.js"></script>


<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;목차</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2024</span>
            
            <a href="/about" target="_blank">Gyuwon Hong</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            
            <br>
            
            
            
            
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link ">
    <a href="https://github.com/keyhong" class="tooltipped" target="_blank" data-tooltip="GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:wnhong96@gmail.com" class="tooltipped" target="_blank" data-tooltip="Email" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>













</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;Search</span>
            <input type="search" id="searchInput" name="s" placeholder="Please enter a search keyword"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- Back to Top Button -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    
    
    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>

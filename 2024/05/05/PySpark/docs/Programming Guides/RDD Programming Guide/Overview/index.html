<!DOCTYPE HTML>
<html lang="en">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Data Engineering,Data Analysis,Python Backend">
    <meta name="description" content="OverviewLinking with SparkInitializing SparkResilient Distributed Datasets (RDDs)스파크는 내결이 ***분산 데이터 집합(RDD, resilient di">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>Keyhong</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    


    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    
        <link rel="stylesheet" type="text/css" href="/css/reward.css">
    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 7.0.0"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span diy-happy-monkey">Keyhong</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>Index</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>Categories</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>Archives</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>About</span>
    </a>
    
  </li>
  
  <li>
    <!-- <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="Search" style="zoom: 0.85;"></i>
    </a> -->
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Keyhong</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			Index
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			Categories
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			Archives
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			About
		</a>
          
        </li>
        
        
    </ul>
</div>


        </div>

        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/0.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title diy-neon-red">
                        </h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                        <div class="article-tag">
                            <i class="far fa-calendar-minus fa-fw"></i>Publish Date:&nbsp;&nbsp;
                                <span class="chip bg-color">
                                    2024-05-05</span>
                        </div>
                    
                    


                </div>
                <div class="col s5 right-align">
                    
                </div>
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.min.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h1><h1 id="Linking-with-Spark"><a href="#Linking-with-Spark" class="headerlink" title="Linking with Spark"></a>Linking with Spark</h1><h1 id="Initializing-Spark"><a href="#Initializing-Spark" class="headerlink" title="Initializing Spark"></a>Initializing Spark</h1><h1 id="Resilient-Distributed-Datasets-RDDs"><a href="#Resilient-Distributed-Datasets-RDDs" class="headerlink" title="Resilient Distributed Datasets (RDDs)"></a>Resilient Distributed Datasets (RDDs)</h1><p>스파크는 내결이 ***분산 데이터 집합(RDD, resilient distributed dataset)***이라는 개념을 중심으로 돌아갑니다. 이는 병렬로 작동할 수 있는 fault-tolerant 컬렉션으로, 요소들의 모음입니다. RDD를 생성하는 두 가지 방법이 있습니다: driver 프로그램에서 기존 컬렉션을 <em><strong>parallelizing</strong></em>하거나, shared filesystem, HDFS, HBase 등 외부 저장 시스템에서 데이터셋을 참조하는 것입니다. Hadoop InputFormat을 제공하는 모든 데이터 소스도 포함됩니다.</p>
<h2 id="Parallelized-Collections"><a href="#Parallelized-Collections" class="headerlink" title="Parallelized Collections"></a>Parallelized Collections</h2><p>기존 컬렉션(Scala Seq)에 대해 <code>SparkContext’s parallelize</code> 메서드를 호출하여 병렬 컬렉션을 생성합니다. 컬렉션의 요소는 복사되어 병렬로 작동할 수 있는 분산 데이터셋을 형성합니다. 예를 들어, 숫자 1부터 5까지를 포함하는 병렬 컬렉션을 만드는 방법은 다음과 같습니다.</p>
<pre class="line-numbers language-scala" data-language="scala"><code class="language-scala"><span class="token keyword">val</span> data <span class="token operator">=</span> Array<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
<span class="token keyword">val</span> distData <span class="token operator">=</span> sc<span class="token punctuation">.</span>parallelize<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>한 번 생성된 분산 데이터셋(<code>distData</code>)은 병렬로 작업할 수 있습니다. 예를 들어, 배열의 요소를 더하기 위해 <code>distData.reduce((a, b) =&gt; a + b)</code>와 같은 방식으로 호출할 수 있습니다. 분산 데이터셋에 대한 작업에 대해 나중에 설명하겠습니다.</p>
<p>병렬 컬렉션의 중요한 매개변수 중 하나는 데이터셋을 잘라내는 <em><strong>partitions</strong></em>의 수입니다. Spark는 클러스터의 각 파티션에 대해 한 번의 작업을 실행합니다. 일반적으로 클러스터의 각 CPU에 2~4개의 파티션을 원합니다. 일반적으로 Spark는 클러스터에 기반하여 자동으로 파티션 수를 설정하려고 시도합니다. 그러나 두 번째 매개변수로 수동으로 설정할 수도 있습니다 (예: <code>sc.parallelize(data, 10)</code>). 참고: 코드의 일부 위치에서는 역호환성을 유지하기 위해 슬라이스(파티션의 동의어)라는 용어를 사용합니다.</p>
<h2 id="External-Datasets"><a href="#External-Datasets" class="headerlink" title="External Datasets"></a>External Datasets</h2><p>Spark는 Hadoop에서 지원하는 모든 저장소 소스, 즉 local file system, HDFS, Cassandra, HBase, <a target="_blank" rel="noopener" href="https://cwiki.apache.org/confluence/display/hadoop/AmazonS3">Amazon S3</a> 등을 통해 분산 데이터셋을 생성할 수 있습니다. 또한 Spark는 text files, <a target="_blank" rel="noopener" href="https://hadoop.apache.org/docs/stable/api/org/apache/hadoop/mapred/SequenceFileInputFormat.html">SequenceFiles</a> 및 기타 모든 Hadoop <a target="_blank" rel="noopener" href="https://hadoop.apache.org/docs/stable/api/org/apache/hadoop/mapred/InputFormat.html">InputFormat</a>을 지원합니다.</p>
<p>Text file RDD는 <code>SparkContext’s textFile</code> 메서드를 사용하여 생성할 수 있습니다. 이 메서드는 파일에 대한 URI(로컬 머신의 로컬 경로 또는 <code>hdfs://</code>, <code>s3a://</code> 등의 URI)를 취하고 해당 파일을 줄의 컬렉션으로 읽습니다. 다음은 예시 호출입니다:</p>
<pre class="line-numbers language-scala" data-language="scala"><code class="language-scala">scala<span class="token operator">></span> <span class="token keyword">val</span> distFile <span class="token operator">=</span> sc<span class="token punctuation">.</span>textFile<span class="token punctuation">(</span><span class="token string">"data.txt"</span><span class="token punctuation">)</span>
distFile<span class="token operator">:</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>spark<span class="token punctuation">.</span>rdd<span class="token punctuation">.</span>RDD<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">.</span>txt MapPartitionsRDD<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> at textFile at <span class="token generics"><span class="token punctuation">&lt;</span>console<span class="token punctuation">></span></span><span class="token operator">:</span><span class="token number">26</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>한 번 생성된 <code>distFile</code>은 데이터셋 작업에 의해 처리될 수 있습니다. 예를 들어, 다음과 같이 <code>map</code> 및 <code>reduce</code> 작업을 사용하여 모든 줄의 크기를 합산할 수 있습니다: <code>distFile.map(s =&gt; s.length).reduce((a, b) =&gt; a + b)</code>.</p>
<br>

<p>파일을 Spark로 읽을 때 몇 가지 주의할 사항이 있습니다:</p>
<ul>
<li><p>로컬 파일 시스템의 경로를 사용하는 경우, 해당 파일은 워커 노드에서도 동일한 경로로 접근 가능해야 합니다. 파일을 모든 워커에 복사하거나 네트워크 마운트된 공유 파일 시스템을 사용하세요.</p>
</li>
<li><p>모든 Spark의 file-based input 메서드(<code>textFile</code> 포함)는 디렉토리, 압축 파일 및 와일드카드를 지원합니다. 예를 들어, <code>textFile(&quot;/my/directory&quot;)</code>, <code>textFile(&quot;/my/directory/*.txt&quot;)</code>, 그리고 <code>textFile(&quot;/my/directory/*.gz&quot;)</code>를 사용할 수 있습니다. 여러 파일을 읽을 때, 파티션의 순서는 파일 시스템에서 파일이 반환되는 순서에 따라 달라집니다. 예를 들어, 파일 경로에 따라 사전식 순서로 되어 있을 수도 있고 아닐 수도 있습니다. 파티션 내에서는 요소가 기본 파일의 순서에 따라 정렬됩니다.</p>
</li>
<li><p><code>textFile</code> 메서드는 파일의 파티션 수를 제어하기 위한 선택적 두 번째 인수도 받습니다. 기본적으로, Spark는 파일의 각 블록마다 하나의 파티션을 생성합니다 (기본적으로 HDFS에서 블록 크기는 128MB입니다). 그러나 더 높은 수의 파티션을 요청하여 더 많은 파티션을 생성할 수도 있습니다. 블록보다 적은 파티션을 가질 수 없다는 점에 유의하세요.</p>
</li>
</ul>
<br>

<p>텍스트 파일 이외에도, Spark의 Scala API는 여러 다른 데이터 형식도 지원합니다:</p>
<ul>
<li><p><code>SparkContext.wholeTextFiles</code> 메서드를 사용하면 여러 개의 작은 텍스트 파일이 포함된 디렉토리를 읽고 각각을 (파일 이름, 내용) 쌍으로 반환합니다. 이는 각 파일의 각 줄마다 하나의 레코드를 반환하는 <code>textFile</code>과 대조적입니다. 파티션은 데이터 로컬리티에 의해 결정되며, 경우에 따라 너무 적은 파티션을 생성할 수 있습니다. 이러한 경우에는 <code>wholeTextFiles</code>가 최소 파티션 수를 제어하기 위한 선택적 두 번째 인수를 제공합니다.</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://hadoop.apache.org/docs/stable/api/org/apache/hadoop/mapred/SequenceFileInputFormat.html">SequenceFiles</a>의 경우, 파일에서 키와 값의 타입을 나타내는 K 및 V 유형을 사용하여 SparkContext의 <code>sequenceFile[K, V]</code> 메서드를 사용하세요. 이러한 유형은 <a target="_blank" rel="noopener" href="https://hadoop.apache.org/docs/stable/api/org/apache/hadoop/io/IntWritable.html">IntWritable</a> 및 <a target="_blank" rel="noopener" href="https://hadoop.apache.org/docs/stable/api/org/apache/hadoop/io/Text.html">Text</a>와 같이 Hadoop의 <a target="_blank" rel="noopener" href="https://hadoop.apache.org/docs/stable/api/org/apache/hadoop/io/Writable.html">Writable</a> 인터페이스의 하위 클래스여야 합니다. 또한, Spark는 일부 일반적인 Writable에 대한 원시 유형을 지정할 수 있도록 허용합니다. 예를 들어, <code>sequenceFile[Int, String]</code>은 IntWritable 및 Text를 자동으로 읽어 들입니다.</p>
</li>
<li><p>다른 Hadoop InputFormat에 대해서는, 임의의 <code>JobConf</code>와 입력 포맷 클래스, 키 클래스 및 값 클래스를 취하는 <code>SparkContext.hadoopRDD</code> 메서드를 사용할 수 있습니다. 입력 소스로 Hadoop 작업을 수행할 때와 동일한 방식으로 이러한 값을 설정하세요. 또한 “new” MapReduce API(<code>org.apache.hadoop.mapreduce</code>)를 기반으로 하는 InputFormat에 대해서는 <code>SparkContext.newAPIHadoopRDD</code>를 사용할 수 있습니다.</p>
</li>
<li><p><code>RDD.saveAsObjectFile</code> 및 <code>SparkContext.objectFile</code>은 직렬화된 Java 객체로 구성된 간단한 형식으로 RDD를 저장하는 기능을 지원합니다. 이는 Avro와 같은 특수한 형식만큼 효율적이지는 않지만, 모든 RDD를 쉽게 저장할 수 있는 방법을 제공합니다.</p>
</li>
</ul>
<h2 id="RDD-Operations"><a href="#RDD-Operations" class="headerlink" title="RDD Operations"></a>RDD Operations</h2><p>RDD는 두 가지 유형의 작업을 지원합니다: <em><strong>transformations</strong></em>은 기존 데이터셋에서 새로운 데이터셋을 생성하며, <em><strong>actions</strong></em>은 데이터셋에 대한 계산을 실행한 후 driver 프로그램으로 값을 반환합니다. 예를 들어, <code>map</code>은 각 데이터셋 요소를 함수를 통해 전달하고 결과를 나타내는 새로운 RDD를 반환하는 변환입니다. 반면에, <code>reduce</code>는 일부 함수를 사용하여 RDD의 모든 요소를 집계하고 최종 결과를 드라이버 프로그램에 반환하는 액션입니다(또한 분산 데이터셋을 반환하는 병렬 <code>reduceByKey</code>도 있습니다).</p>
<p>모든 Spark의 변환은 <em><strong>lazy</strong></em>되어 바로 결과를 계산하지 않습니다. 대신, 그들은 단지 어떤 기본 데이터셋(예: file)에 적용된 변환들을 기억합니다. 변환은 액션이 결과를 driver 프로그램으로 반환하는 것을 요구할 때에만 계산됩니다. 이 설계는 Spark가 더 효율적으로 실행되도록 합니다. 예를 들어, <code>map</code>을 통해 생성된 데이터셋이 <code>reduce</code>에서 사용될 것을 알고 결과로서 <code>reduce</code>만을 driver에 반환하며, 더 큰 매핑된 데이터셋을 반환하지 않습니다.</p>
<p>기본적으로 각 변환된 RDD는 action을 실행할 때마다 다시 계산될 수 있습니다. 그러나 <code>persist</code>(또는 <code>cache</code>) 메서드를 사용하여 RDD를 메모리에 <em><strong>persist</strong></em> 할 수도 있습니다. 이 경우 Spark는 클러스터에서 요소를 보관하여 다음에 쿼리할 때 훨씬 빠른 액세스를 제공합니다. 또한 디스크에 RDD를 지속시키거나 여러 노드에 복제할 수 있는 기능도 있습니다.</p>
<h3 id="Basics"><a href="#Basics" class="headerlink" title="Basics"></a>Basics</h3><p>RDD 기본 개념을 설명하기 위해 아래의 간단한 프로그램을 고려해 보겠습니다:</p>
<pre class="line-numbers language-scala" data-language="scala"><code class="language-scala"><span class="token keyword">val</span> lines <span class="token operator">=</span> sc<span class="token punctuation">.</span>textFile<span class="token punctuation">(</span><span class="token string">"data.txt"</span><span class="token punctuation">)</span>
<span class="token keyword">val</span> lineLengths <span class="token operator">=</span> lines<span class="token punctuation">.</span>map<span class="token punctuation">(</span>s <span class="token keyword">=></span> s<span class="token punctuation">.</span>length<span class="token punctuation">)</span>
<span class="token keyword">val</span> totalLength <span class="token operator">=</span> lineLengths<span class="token punctuation">.</span>reduce<span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token keyword">=></span> a <span class="token operator">+</span> b<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>첫 번째 줄은 외부 파일에서 기본 RDD를 정의합니다. 이 데이터셋은 메모리에 로드되거나 다른 방식으로 처리되지 않습니다: <code>lines</code>는 단순히 파일을 가리키는 포인터일 뿐입니다. 두 번째 줄은 map 변환의 결과로 <code>lineLengths</code>를 정의합니다. 다시 말해, <code>lineLengths</code>는 지연 때문에 즉시 계산되지 않습니다. 마지막으로, 우리는 액션인 <code>reduce</code>를 실행합니다. 이 시점에서 Spark는 계산을 별도의 기계에서 실행할 작업으로 나누고, 각 기계는 맵의 일부와 로컬 감소를 실행하여 답변을 드라이버 프로그램에 반환합니다.</p>
<p>나중에 <code>lineLengths</code>를 다시 사용하고 싶다면, 다음을 추가할 수 있습니다:</p>
<pre class="line-numbers language-scala" data-language="scala"><code class="language-scala">lineLengths<span class="token punctuation">.</span>persist<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><code>reduce</code> 이전에 추가하면, <code>lineLengths</code>가 처음 계산된 후에 메모리에 저장됩니다.</p>
<h3 id="Passing-Functions-to-Spark"><a href="#Passing-Functions-to-Spark" class="headerlink" title="Passing Functions to Spark"></a>Passing Functions to Spark</h3><p>Spark의 API는 클러스터에서 실행되도록 드라이버 프로그램에 함수를 전달하는 데 매우 의존합니다. 이를 수행하는 두 가지 권장 방법이 있습니다:</p>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://docs.scala-lang.org/tour/basics.html#functions">Anonymous function syntax</a>은 코드 조각을 위해 사용될 수 있습니다.</p>
</li>
<li><p>전역 싱글톤 객체의 정적 메소드. 예를 들어, <code>object MyFunctions</code>를 정의하고 <code>MyFunctions.func1</code>을 전달할 수 있습니다:</p>
</li>
</ul>
<pre class="line-numbers language-scala" data-language="scala"><code class="language-scala"><span class="token keyword">object</span> MyFunctions <span class="token punctuation">&#123;</span>
    <span class="token keyword">def</span> func1<span class="token punctuation">(</span>s<span class="token operator">:</span> string<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">String</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

myRdd<span class="token punctuation">.</span>map<span class="token punctuation">(</span>MyFunctions<span class="token punctuation">.</span>func1<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>주의: 클래스 인스턴스의 메소드 참조를 전달하는 것도 가능하지만 (싱글톤 객체가 아닌 경우), 이는 해당 클래스를 포함한 객체를 메소드와 함께 전송해야 한다는 것을 의미합니다.</p>
<pre class="line-numbers language-scala" data-language="scala"><code class="language-scala"><span class="token keyword">class</span> MyClass <span class="token punctuation">&#123;</span>
    <span class="token keyword">def</span> func1<span class="token punctuation">(</span>s<span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">String</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">&#125;</span>
    <span class="token keyword">def</span> doStuff<span class="token punctuation">(</span>rdd<span class="token operator">:</span> RDD<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> RDD<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> rdd<span class="token punctuation">.</span>map<span class="token punctuation">(</span>func1<span class="token punctuation">)</span> <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>여기서 우리가 새로운 <code>MyClass</code> 인스턴스를 생성하고 그것의 <code>doStuff</code>를 호출하면, 그 안의 <code>map</code>은 해당 <em><strong>MyClass</strong></em> 인스턴스의 <code>func1</code> 메소드를 참조하기 때문에 전체 객체를 클러스터로 보내야 합니다. 이는 <code>rdd.map(x =&gt; this.func1(x))</code>을 작성하는 것과 유사합니다.</p>
<p>비슷한 방식으로, 외부 객체의 필드에 접근하는 것은 전체 객체를 참조할 것입니다.</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">MyClass</span> <span class="token punctuation">&#123;</span>
    val field <span class="token operator">=</span> <span class="token string">"Hello"</span>
    def <span class="token function">doStuff</span><span class="token punctuation">(</span>rdd<span class="token operator">:</span> <span class="token constant">RDD</span><span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">RDD</span><span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> rdd<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>x <span class="token operator">=</span><span class="token operator">></span> field <span class="token operator">+</span> x<span class="token punctuation">)</span> <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>이는 <code>rdd.map(x =&gt; this.field + x)</code>를 작성하는 것과 동등하며, 이는 <code>this</code> 전체를 참조합니다. 이 문제를 피하기 위한 가장 간단한 방법은 외부에서 접근하는 대신에 <code>field</code>를 지역 변수로 복사하는 것입니다.</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">def <span class="token function">doStuff</span><span class="token punctuation">(</span>rdd<span class="token operator">:</span> <span class="token constant">RDD</span><span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">RDD</span><span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    val field_ <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>field
    rdd<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>x <span class="token operator">=</span><span class="token operator">></span> field_ <span class="token operator">+</span> x<span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="Understanding-closures"><a href="#Understanding-closures" class="headerlink" title="Understanding closures"></a>Understanding closures</h3><p>Spark에서 이해하기 어려운 점 중 하나는 코드를 클러스터 전체에서 실행할 때 변수와 메소드의 범위와 생명 주기를 이해하는 것입니다. 범위 외부의 변수를 수정하는 RDD 작업은 혼란의 주요 원인이 될 수 있습니다. 아래 예제에서는 <code>foreach()</code>를 사용하여 카운터를 증가시키는 코드를 살펴보겠습니다. 그러나 이와 유사한 문제는 다른 작업에서도 발생할 수 있습니다.</p>
<h4 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h4><p>아래의 단순한 RDD 요소 합계를 고려해보세요. 실행이 동일한 JVM 내에서 이루어지는지 여부에 따라 다르게 작동할 수 있습니다. 이런 경우의 일반적인 예는 스파크를 <code>local</code> mode(<code>--master=local[n]</code>)로 실행하는 경우와 스파크 애플리케이션을 클러스터에 배포하는 경우(예: spark-submit을 사용하여 YARN에)입니다.</p>
<h4 id="Local-vs-cluster-modes"><a href="#Local-vs-cluster-modes" class="headerlink" title="Local vs. cluster modes"></a>Local vs. cluster modes</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">var</span> counter <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">var</span> rdd <span class="token operator">=</span> sc<span class="token punctuation">.</span><span class="token function">parallelize</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>

<span class="token comment">// Wrong: Dont't do this!!</span>
rdd<span class="token punctuation">.</span><span class="token function">foreach</span><span class="token punctuation">(</span>x <span class="token operator">=</span><span class="token operator">></span> counter <span class="token operator">+=</span> x<span class="token punctuation">)</span>

<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Counter value: "</span> <span class="token operator">+</span> counter<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>위 코드의 동작은 정의되지 않았으며, 의도한 대로 작동하지 않을 수 있습니다. 작업을 실행하기 위해 Spark는 RDD operations을 tasks로 분할하고, 각 작업은 executor에 의해 실행됩니다. 실행 전에 Spark는 작업의 <code>closure</code>를 계산합니다. 클로저는 executor가 RDD(이 경우 <code>foreach()</code>)에서 계산을 수행하기 위해 볼 수 있어야 하는 변수와 메서드입니다. 이 클로저는 직렬화되어 각 executor로 전송됩니다.</p>
<h4 id="Printing-elements-of-an-RDD"><a href="#Printing-elements-of-an-RDD" class="headerlink" title="Printing elements of an RDD"></a>Printing elements of an RDD</h4><h3 id="Working-with-Key-Value-Pairs"><a href="#Working-with-Key-Value-Pairs" class="headerlink" title="Working with Key-Value Pairs"></a>Working with Key-Value Pairs</h3><h3 id="Transformations"><a href="#Transformations" class="headerlink" title="Transformations"></a>Transformations</h3><h3 id="Actions"><a href="#Actions" class="headerlink" title="Actions"></a>Actions</h3><h3 id="Shuffle-operations"><a href="#Shuffle-operations" class="headerlink" title="Shuffle operations"></a>Shuffle operations</h3><h4 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h4><h4 id="Performance-Impact"><a href="#Performance-Impact" class="headerlink" title="Performance Impact"></a>Performance Impact</h4><h2 id="RDD-Persistence"><a href="#RDD-Persistence" class="headerlink" title="RDD Persistence"></a>RDD Persistence</h2><h3 id="Which-Storage-Level-to-Choose"><a href="#Which-Storage-Level-to-Choose" class="headerlink" title="Which Storage Level to Choose?"></a>Which Storage Level to Choose?</h3><h3 id="Removing-Data"><a href="#Removing-Data" class="headerlink" title="Removing Data"></a>Removing Data</h3><h1 id="Shared-Variables"><a href="#Shared-Variables" class="headerlink" title="Shared Variables"></a>Shared Variables</h1><h2 id="Broadcast-Variables"><a href="#Broadcast-Variables" class="headerlink" title="Broadcast Variables"></a>Broadcast Variables</h2><h2 id="Accumulators"><a href="#Accumulators" class="headerlink" title="Accumulators"></a>Accumulators</h2><h1 id="Deploying-to-a-Cluster"><a href="#Deploying-to-a-Cluster" class="headerlink" title="Deploying to a Cluster"></a>Deploying to a Cluster</h1><h1 id="Launching-Spark-jobs-from-Java-Scala"><a href="#Launching-Spark-jobs-from-Java-Scala" class="headerlink" title="Launching Spark jobs from Java &#x2F; Scala"></a>Launching Spark jobs from Java &#x2F; Scala</h1><h1 id="Unit-Testing"><a href="#Unit-Testing" class="headerlink" title="Unit Testing"></a>Unit Testing</h1><h1 id="Where-to-Go-from-Here"><a href="#Where-to-Go-from-Here" class="headerlink" title="Where to Go from Here"></a>Where to Go from Here</h1>
                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        Author:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">Gyuwon Hong</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        Link:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://example.com/2024/05/05/PySpark/docs/Programming%20Guides/RDD%20Programming%20Guide/Overview/">http://example.com/2024/05/05/PySpark/docs/Programming%20Guides/RDD%20Programming%20Guide/Overview/</a>
                </span>
            </div>
            <!-- <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        reprint:
                    </i>
                </span>
                <span class="reprint-info">
                    use
                    <a href="cc_by_url" rel="external nofollow noreferrer" target="_blank">cc_by_name</a>
                    licensed
                    <a href="/about" target="_blank">Gyuwon Hong</a>
                    !
                </span>
            </div> -->
        
    </div>

    <!-- <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>Copied successfully, please follow the reprint policy of this article</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">more</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script> -->



            <div class="tag_share" style="display: block;">
                <!-- <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            <span class="chip bg-color">No tag</span>
                        </div>
                    
                </div> -->
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    

    

</div>

                </div>
            </div>
            
                <div id="reward">
    <!-- <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a> -->

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    
        <link rel="stylesheet" href="/libs/gitment/gitment-default.css">
<link rel="stylesheet" href="/css/gitment.css">

<div class="gitment-card card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; padding-left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>댓글</span>
    </div>
    <div id="gitment-content" class="card-content"></div>
</div>

<script src="/libs/gitment/gitment.js"></script>
<script>
var gitment = new Gitment({
    id: 'Sun May 05 2024 22:16:05 GMT+0900',
    owner: '',
    repo: '',
    oauth: {
        client_id: '',
        client_secret: ''
    }
});

gitment.render('gitment-content');
</script>

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="far fa-dot-circle"></i>&nbsp;Current
            </div>
            <div class="card">
                <a href="/2024/05/05/PySpark/docs/Programming%20Guides/RDD%20Programming%20Guide/Overview/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/0.jpg" class="responsive-img" alt="">
                        
                        <span class="card-title diy-neon-yellow"></span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2024-05-05
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            Gyuwon Hong
                            
                        </span>
                    </div>
                </div>

                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                Next&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2024/05/05/PySpark/docs/pyspark/Getting%20Started/Testing%20PySpark/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/0.jpg" class="responsive-img" alt="">
                        
                        <span class="card-title diy-neon-red"></span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2024-05-05
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            Gyuwon Hong
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>


  <!-- 是否加载使用自带的 prismjs. -->
  <script type="text/javascript" src="/libs/prism/prism.min.js"></script>


<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;목차</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2024</span>
            
            <a href="/about" target="_blank">Gyuwon Hong</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            
            <br>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;Total visits:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;Total visitors:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/keyhong" class="tooltipped" target="_blank" data-tooltip="GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:wnhong96@gmail.com" class="tooltipped" target="_blank" data-tooltip="Email" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>













</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;Search</span>
            <input type="search" id="searchInput" name="s" placeholder="Please enter a search keyword"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 白天和黑夜主题 -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    
    
    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>

<!DOCTYPE HTML>
<html lang="en">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="[SQL] Cross Join, Data Engineering,Data Analysis,Python Backend">
    <meta name="description" content="조인(Join)
두 개의 테이블을 특정 기준 컬럼으로 결합하는 일

조인 Tip
Outer Table의 결과 집합이 작아야 한다 (Left join의 왼쪽 편에 있는 데이터의 size가 작아야 한다)

Inner L">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>[SQL] Cross Join | Keyhong</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    


    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    
        <link rel="stylesheet" type="text/css" href="/css/reward.css">
    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 7.0.0"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span diy-happy-monkey">Keyhong</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>Index</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>Categories</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>About</span>
    </a>
    
  </li>
  
  <!-- <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="Search" style="zoom: 0.85;"></i>
    </a>
  </li> -->
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Keyhong</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			Index
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			Categories
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			About
		</a>
          
        </li>
        
        
    </ul>
</div>


        </div>

        
    </nav>

</header>

    

<div class="bg-cover pd-header post-cover" style="background-image: url('/images/logos/sql-logo.png')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title diy-neon-red">
                        [SQL] Cross Join</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                        <div class="article-tag">
                            <i class="far fa-calendar-minus fa-fw"></i>Publish Date:&nbsp;&nbsp;
                                <span class="chip bg-color">
                                    2023-08-20</span>
                        </div>
                    
                    


                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/SQL/" class="post-category">
                                SQL
                            </a>
                        
                    </div>
                    
                </div>
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.min.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h2 id="조인-Join"><a href="#조인-Join" class="headerlink" title="조인(Join)"></a>조인(Join)</h2><blockquote>
<p>두 개의 테이블을 특정 기준 컬럼으로 결합하는 일</p>
</blockquote>
<h2 id="조인-Tip"><a href="#조인-Tip" class="headerlink" title="조인 Tip"></a>조인 Tip</h2><ul>
<li><p>Outer Table의 결과 집합이 작아야 한다 (Left join의 왼쪽 편에 있는 데이터의 size가 작아야 한다)</p>
</li>
<li><p>Inner Loop의 조인 컬럼에 인덱스가 있으면 효율적(인덱스는 값과 위치를 미리 정렬했기 때문)</p>
</li>
</ul>
<h2 id="Cross-Join"><a href="#Cross-Join" class="headerlink" title="Cross Join"></a>Cross Join</h2><p>흔히 카테시안 곱(Cartesian Product)으로 불리는 조인이다. M개의 행을 가진 테이블과 N개의 행을 가진 테이블을 cross-join 시키면 M*N개의 행이 나온다. 즉 두 테이블이 가진 개별 행들을 서로의 행과 join 기준 컬럼 없이 결합한다. cross-join에서 성능을 기대하기는 쉽지 않다. 다만, 카테시안을 이용한 모든 곱이 필요한 경우 사용하며 결과로 나오는 행은 엄청 크기 때문에 메모리 부족을 항상 경계해야 한다. </p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">    
<span class="token comment">-- 테이블 A </span>
<span class="token comment">-----------------</span>
<span class="token operator">|</span> col_a <span class="token operator">|</span> col_b <span class="token operator">|</span>
<span class="token comment">-----------------</span>
<span class="token operator">|</span> <span class="token number">1</span>     <span class="token operator">|</span> a     <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2</span>     <span class="token operator">|</span> b     <span class="token operator">|</span>
<span class="token comment">-----------------</span>

<span class="token comment">-- 테이블 B</span>
<span class="token comment">-----------------</span>
<span class="token operator">|</span> col_c <span class="token operator">|</span> col_d <span class="token operator">|</span>
<span class="token comment">-----------------</span>
<span class="token operator">|</span> <span class="token number">3</span>    <span class="token operator">|</span> c      <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">4</span>    <span class="token operator">|</span> d      <span class="token operator">|</span>
<span class="token comment">-----------------</span>

<span class="token comment">-- 카테시안 곱 생성</span>
<span class="token keyword">SELECT</span> 
  tb1<span class="token punctuation">.</span>col_a<span class="token punctuation">,</span>
  tb1<span class="token punctuation">.</span>col_b<span class="token punctuation">,</span>
  tb2<span class="token punctuation">.</span>col_c<span class="token punctuation">,</span>
  tb2<span class="token punctuation">.</span>col_d
<span class="token keyword">FROM</span> tb1
<span class="token keyword">CROSS</span> <span class="token keyword">JOIN</span> tb2<span class="token punctuation">;</span>

<span class="token comment">/** cross join 결과
-------------------------------
col_a | col_b | col_c | col_d |
-------------------------------
    1 | a     |     3 | c     |
    1 | a     |     4 | d     |
    2 | b     |     3 | c     |
    2 | b     |     4 | d     |
-------------------------------
*/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="values"><a href="#values" class="headerlink" title="values"></a>values</h2><p>values를 이용하면 cross-join을 할 때 조인 대상이 되는 간단한 배열을 만들 수 있따.</p>
<ul>
<li>보통 “INSERT INTO &lt;테이블&gt; VALUES &lt;값&gt;” 에 주로 사용된다.</li>
<li>values 는 하나의 행을 소괄호’()’ 로 묶고 쉼표로 구분한다.</li>
<li>values를 이용한 다양한 활용이 가능하다.</li>
</ul>
<h2 id="실전-예제-Cross-Join을-위해-사용한-UNION-ALL-대체하기"><a href="#실전-예제-Cross-Join을-위해-사용한-UNION-ALL-대체하기" class="headerlink" title="실전 예제 : Cross Join을 위해 사용한 UNION ALL 대체하기"></a>실전 예제 : Cross Join을 위해 사용한 UNION ALL 대체하기</h2><p>실제 프로젝트에서 내가 기존의 쿼리를 간소화 시켰던 예제이다. 모든 데이터에 대해 00시~23시 까지의 모든 값을 넣은 행을 새로 만드는 쿼리 였다. Cross Join(카디션 곱, 프로덕션 곱이라고도 말한다.)을 사용했는 데, 기존 쿼리의 경우 아래와 같이 UNION ALL을 이용하여 Join을 수행할 신규 테이블을 만드는 작업을 한다. 이 쿼리에 있어 테이블을 만들어 곱을 수행하는 것이 아닌, values를 이용해 값의 어레이를 만들어 곱하면 더욱 간편화된 쿼리문을 작성 할 수 있고 수행시간도 더욱 단축 시킬 수가 있었다.</p>
<h4 id="기존-쿼리"><a href="#기존-쿼리" class="headerlink" title="기존 쿼리"></a>기존 쿼리</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">explain</span> <span class="token keyword">analyze</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span>
  <span class="token keyword">FROM</span>
      <span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> <span class="token operator">*</span>
          <span class="token keyword">FROM</span> ADHC<span class="token punctuation">.</span>SERVICE_PCELL_TIME_POP
        <span class="token keyword">WHERE</span> <span class="token keyword">LEFT</span><span class="token punctuation">(</span>STD_YMD<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">'$&#123;C_MONTH&#125;'</span>
          <span class="token punctuation">)</span> SERVICE_PCELL_TIME_POP
<span class="token keyword">CROSS</span> <span class="token keyword">JOIN</span>
          <span class="token punctuation">(</span>
            <span class="token keyword">SELECT</span> TMS<span class="token punctuation">.</span><span class="token operator">*</span>
              <span class="token keyword">FROM</span>
                  <span class="token punctuation">(</span>
                    <span class="token keyword">SELECT</span> <span class="token string">'00'</span> <span class="token keyword">AS</span> TM <span class="token keyword">UNION</span> <span class="token keyword">ALL</span>
                    <span class="token keyword">SELECT</span> <span class="token string">'01'</span> <span class="token keyword">AS</span> TM <span class="token keyword">UNION</span> <span class="token keyword">ALL</span>
                    <span class="token keyword">SELECT</span> <span class="token string">'02'</span> <span class="token keyword">AS</span> TM <span class="token keyword">UNION</span> <span class="token keyword">ALL</span>
                    <span class="token keyword">SELECT</span> <span class="token string">'03'</span> <span class="token keyword">AS</span> TM <span class="token keyword">UNION</span> <span class="token keyword">ALL</span>
                    <span class="token keyword">SELECT</span> <span class="token string">'04'</span> <span class="token keyword">AS</span> TM <span class="token keyword">UNION</span> <span class="token keyword">ALL</span>
                    <span class="token keyword">SELECT</span> <span class="token string">'05'</span> <span class="token keyword">AS</span> TM <span class="token keyword">UNION</span> <span class="token keyword">ALL</span>
                    <span class="token keyword">SELECT</span> <span class="token string">'06'</span> <span class="token keyword">AS</span> TM <span class="token keyword">UNION</span> <span class="token keyword">ALL</span>
                    <span class="token keyword">SELECT</span> <span class="token string">'07'</span> <span class="token keyword">AS</span> TM <span class="token keyword">UNION</span> <span class="token keyword">ALL</span>
                    <span class="token keyword">SELECT</span> <span class="token string">'08'</span> <span class="token keyword">AS</span> TM <span class="token keyword">UNION</span> <span class="token keyword">ALL</span>
                    <span class="token keyword">SELECT</span> <span class="token string">'09'</span> <span class="token keyword">AS</span> TM <span class="token keyword">UNION</span> <span class="token keyword">ALL</span>
                    <span class="token keyword">SELECT</span> <span class="token string">'10'</span> <span class="token keyword">AS</span> TM <span class="token keyword">UNION</span> <span class="token keyword">ALL</span>
                    <span class="token keyword">SELECT</span> <span class="token string">'11'</span> <span class="token keyword">AS</span> TM <span class="token keyword">UNION</span> <span class="token keyword">ALL</span>
                    <span class="token keyword">SELECT</span> <span class="token string">'12'</span> <span class="token keyword">AS</span> TM <span class="token keyword">UNION</span> <span class="token keyword">ALL</span>
                    <span class="token keyword">SELECT</span> <span class="token string">'13'</span> <span class="token keyword">AS</span> TM <span class="token keyword">UNION</span> <span class="token keyword">ALL</span>
                    <span class="token keyword">SELECT</span> <span class="token string">'14'</span> <span class="token keyword">AS</span> TM <span class="token keyword">UNION</span> <span class="token keyword">ALL</span>
                    <span class="token keyword">SELECT</span> <span class="token string">'15'</span> <span class="token keyword">AS</span> TM <span class="token keyword">UNION</span> <span class="token keyword">ALL</span>
                    <span class="token keyword">SELECT</span> <span class="token string">'16'</span> <span class="token keyword">AS</span> TM <span class="token keyword">UNION</span> <span class="token keyword">ALL</span>
                    <span class="token keyword">SELECT</span> <span class="token string">'17'</span> <span class="token keyword">AS</span> TM <span class="token keyword">UNION</span> <span class="token keyword">ALL</span>
                    <span class="token keyword">SELECT</span> <span class="token string">'18'</span> <span class="token keyword">AS</span> TM <span class="token keyword">UNION</span> <span class="token keyword">ALL</span>
                    <span class="token keyword">SELECT</span> <span class="token string">'19'</span> <span class="token keyword">AS</span> TM <span class="token keyword">UNION</span> <span class="token keyword">ALL</span>
                    <span class="token keyword">SELECT</span> <span class="token string">'20'</span> <span class="token keyword">AS</span> TM <span class="token keyword">UNION</span> <span class="token keyword">ALL</span>
                    <span class="token keyword">SELECT</span> <span class="token string">'21'</span> <span class="token keyword">AS</span> TM <span class="token keyword">UNION</span> <span class="token keyword">ALL</span>
                    <span class="token keyword">SELECT</span> <span class="token string">'22'</span> <span class="token keyword">AS</span> TM <span class="token keyword">UNION</span> <span class="token keyword">ALL</span>
                    <span class="token keyword">SELECT</span> <span class="token string">'23'</span> <span class="token keyword">AS</span> TM
                    <span class="token comment">-- ORDER BY TM</span>
                  <span class="token punctuation">)</span> TMS
          <span class="token punctuation">)</span> TMS
<span class="token punctuation">;</span>

<span class="token comment">/* 실행 계획

Nested Loop  (cost=1000.00..152965.98 rows=258024 width=469) (actual time=0.479..41833.706 rows=17591136 loops=1)
  ->  Gather  (cost=1000.00..149740.26 rows=10751 width=437) (actual time=0.457..727.273 rows=732964 loops=1)
        Workers Planned: 2
        Workers Launched: 2
        ->  Parallel Seq Scan on service_pcell_time_pop  (cost=0.00..147665.16 rows=4480 width=437) (actual time=0.037..495.673 rows=244321 loops=3)
              Filter: ("left"((std_ymd)::text, 6) = '201901'::text)
              Rows Removed by Filter: 472885
  ->  Materialize  (cost=0.00..0.48 rows=24 width=32) (actual time=0.001..0.017 rows=24 loops=732964)
        ->  Append  (cost=0.00..0.36 rows=24 width=32) (actual time=0.004..0.131 rows=24 loops=1)
              ->  Result  (cost=0.00..0.01 rows=1 width=32) (actual time=0.002..0.004 rows=1 loops=1)
              ->  Result  (cost=0.00..0.01 rows=1 width=32) (actual time=0.001..0.002 rows=1 loops=1)
              ->  Result  (cost=0.00..0.01 rows=1 width=32) (actual time=0.001..0.002 rows=1 loops=1)
              ->  Result  (cost=0.00..0.01 rows=1 width=32) (actual time=0.001..0.002 rows=1 loops=1)
              ->  Result  (cost=0.00..0.01 rows=1 width=32) (actual time=0.001..0.003 rows=1 loops=1)
              ->  Result  (cost=0.00..0.01 rows=1 width=32) (actual time=0.001..0.002 rows=1 loops=1)
              ->  Result  (cost=0.00..0.01 rows=1 width=32) (actual time=0.001..0.002 rows=1 loops=1)
              ->  Result  (cost=0.00..0.01 rows=1 width=32) (actual time=0.001..0.002 rows=1 loops=1)
              ->  Result  (cost=0.00..0.01 rows=1 width=32) (actual time=0.001..0.002 rows=1 loops=1)
              ->  Result  (cost=0.00..0.01 rows=1 width=32) (actual time=0.001..0.003 rows=1 loops=1)
              ->  Result  (cost=0.00..0.01 rows=1 width=32) (actual time=0.001..0.002 rows=1 loops=1)
              ->  Result  (cost=0.00..0.01 rows=1 width=32) (actual time=0.001..0.002 rows=1 loops=1)
              ->  Result  (cost=0.00..0.01 rows=1 width=32) (actual time=0.001..0.002 rows=1 loops=1)
              ->  Result  (cost=0.00..0.01 rows=1 width=32) (actual time=0.001..0.002 rows=1 loops=1)
              ->  Result  (cost=0.00..0.01 rows=1 width=32) (actual time=0.001..0.003 rows=1 loops=1)
              ->  Result  (cost=0.00..0.01 rows=1 width=32) (actual time=0.001..0.002 rows=1 loops=1)
              ->  Result  (cost=0.00..0.01 rows=1 width=32) (actual time=0.001..0.002 rows=1 loops=1)
              ->  Result  (cost=0.00..0.01 rows=1 width=32) (actual time=0.001..0.003 rows=1 loops=1)
              ->  Result  (cost=0.00..0.01 rows=1 width=32) (actual time=0.001..0.002 rows=1 loops=1)
              ->  Result  (cost=0.00..0.01 rows=1 width=32) (actual time=0.001..0.002 rows=1 loops=1)
              ->  Result  (cost=0.00..0.01 rows=1 width=32) (actual time=0.001..0.002 rows=1 loops=1)
              ->  Result  (cost=0.00..0.01 rows=1 width=32) (actual time=0.001..0.002 rows=1 loops=1)
              ->  Result  (cost=0.00..0.01 rows=1 width=32) (actual time=0.001..0.002 rows=1 loops=1)
              ->  Result  (cost=0.00..0.01 rows=1 width=32) (actual time=0.001..0.002 rows=1 loops=1)
Planning Time: 0.587 ms
Execution Time: 53457.058 ms
*/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>보다시피 UNION ALL을 하면  쿼리가 세로로 길어지고 실행 계획도 더불어 길어지게 된다.</p>
<h4 id="수정-쿼리"><a href="#수정-쿼리" class="headerlink" title="수정 쿼리"></a>수정 쿼리</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">explain</span> <span class="token keyword">analyze</span>
    <span class="token keyword">SELECT</span> <span class="token operator">*</span>
      <span class="token keyword">FROM</span>
          <span class="token punctuation">(</span>
            <span class="token keyword">SELECT</span> <span class="token operator">*</span>
              <span class="token keyword">FROM</span> ADHC<span class="token punctuation">.</span>SERVICE_PCELL_TIME_POP
            <span class="token keyword">WHERE</span> <span class="token keyword">LEFT</span><span class="token punctuation">(</span>STD_YMD<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">'$&#123;C_MONTH&#125;'</span>
          <span class="token punctuation">)</span> SERVICE_PCELL_TIME_POP
<span class="token keyword">CROSS</span> <span class="token keyword">JOIN</span> <span class="token punctuation">(</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'01'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'02'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'03'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'04'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'05'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'06'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'07'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'08'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token punctuation">(</span><span class="token string">'09'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'10'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'11'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'12'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'13'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'14'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'15'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'16'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'17'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token punctuation">(</span><span class="token string">'18'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'19'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'20'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'21'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'22'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'23'</span><span class="token punctuation">)</span>
          <span class="token punctuation">)</span> TMS <span class="token punctuation">(</span>TM<span class="token punctuation">)</span>
<span class="token punctuation">;</span>

<span class="token comment">/* 실행 계획

Nested Loop  (cost=1000.00..152965.92 rows=258024 width=469) (actual time=0.579..41671.912 rows=17591136 loops=1)
  ->  Gather  (cost=1000.00..149740.26 rows=10751 width=437) (actual time=0.560..732.158 rows=732964 loops=1)
        Workers Planned: 2
        Workers Launched: 2
        ->  Parallel Seq Scan on daegu_service_pcell_time_pop  (cost=0.00..147665.16 rows=4480 width=437) (actual time=0.038..493.889 rows=244321 loops=3)
              Filter: ("left"((std_ymd)::text, 6) = '201901'::text)
              Rows Removed by Filter: 472885
  ->  Materialize  (cost=0.00..0.42 rows=24 width=32) (actual time=0.001..0.017 rows=24 loops=732964)
        ->  Values Scan on "*VALUcES*"  (cost=0.00..0.30 rows=24 width=32) (actual time=0.003..0.025 rows=24 loops=1)
Planning Time: 0.249 ms
Execution Time: 53296.674 ms
*/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>쿼리문과 실행 계획 모두 짧아졌다. 물론 이와 같은 방법은 cross-join을 할 대상이 단일 열일 때 해당하는 바이다. 성능의 큰 차이가 없다면 그래도 짧고 보기 좋은 쿼리가 함께 공유하기 좋지 않을까 :)</p>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        Author:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">Keyhong</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        Link:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://example.com/2023/08/20/SQL/cross-join/">http://example.com/2023/08/20/SQL/cross-join/</a>
                </span>
            </div>
            <!-- <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        reprint:
                    </i>
                </span>
                <span class="reprint-info">
                    use
                    <a href="cc_by_url" rel="external nofollow noreferrer" target="_blank">cc_by_name</a>
                    licensed
                    <a href="/about" target="_blank">Keyhong</a>
                    !
                </span>
            </div> -->
        
    </div>

    <!-- <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>Copied successfully, please follow the reprint policy of this article</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">more</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script> -->



            <div class="tag_share" style="display: block;">
                <!-- <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            <span class="chip bg-color">No tag</span>
                        </div>
                    
                </div> -->
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    

    

</div>

                </div>
            </div>
            
                <div id="reward">
    <!-- <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a> -->

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    


    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;Previous</div>
            <div class="card">
                <a href="/2023/09/01/Kafka/kafka-basic/">
                    <div class="card-image">
                        
                        <img src="/images/logos/kafka-logo.png" class="responsive-img" alt="Kafka Basic Concept">
                        
                        <span class="card-title diy-neon-red">Kafka Basic Concept</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2023-09-01
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Kafka/" class="post-category">
                                    Kafka
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                Next&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2023/08/20/SQL/psql-command/">
                    <div class="card-image">
                        
                        <img src="/images/logos/postgres-logo.png" class="responsive-img" alt="[Postgresql] psql cli">
                        
                        <span class="card-title diy-neon-red">[Postgresql] psql cli</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2023-08-20
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Postgresql/" class="post-category">
                                    Postgresql
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>


  <!-- 是否加载使用自带的 prismjs. -->
  <script type="text/javascript" src="/libs/prism/prism.min.js"></script>


<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;목차</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2024</span>
            
            <a href="/about" target="_blank">Gyuwon Hong</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            
            <br>
            
            
            
            
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link ">
    <a href="https://github.com/keyhong" class="tooltipped" target="_blank" data-tooltip="GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:wnhong96@gmail.com" class="tooltipped" target="_blank" data-tooltip="Email" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>













</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;Search</span>
            <input type="search" id="searchInput" name="s" placeholder="Please enter a search keyword"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- Back to Top Button -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    
    
    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
